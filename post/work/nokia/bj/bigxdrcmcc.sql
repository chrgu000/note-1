SELECT
  tbb.INITIAL_REGISTER_ATTEMPT as INITIAL_REGISTER_ATTEMPT,
  tbb.INITIAL_REGISTER_SUCC as INITIAL_REGISTER_SUCC,
  tbb.INITIAL_REGISTER_LATENCY_ALL as INITIAL_REGISTER_LATENCY_ALL,
  tbb.RE_REGISTER_ATTEMPT as RE_REGISTER_ATTEMPT,
  tbb.RE_REGISTER_SUCC as RE_REGISTER_SUCC,
  tbb.RE_REGISTER_LATENCY_ALL as RE_REGISTER_LATENCY_ALL,
  tbb.REGISTER_ATTEMPT as REGISTER_ATTEMPT,
  tbb.REGISTER_SUCC as REGISTER_SUCC,
  tbb.REGISTER_LATENCY_ALL as REGISTER_LATENCY_ALL,
  tbb.DEREGISTER_ATTEMPT as DEREGISTER_ATTEMPT,
  tbb.DEREGISTER_SUCC as DEREGISTER_SUCC,
  tbb.DEREGISTER_LATENCY_ALL as DEREGISTER_LATENCY_ALL,
  tbb.SBC_REGISTER_SUCC_ATTEMPT as SBC_REGISTER_SUCC_ATTEMPT,
  tbb.SBC_REGISTER_SUCC as SBC_REGISTER_SUCC,
  tbb.SCSCF_REGISTER_SUCC_ATTEMPT as SCSCF_REGISTER_SUCC_ATTEMPT,
  tbb.SCSCF_REGISTER_SUCC as SCSCF_REGISTER_SUCC,
  tbb.MAR_ATTEMPT as MAR_ATTEMPT,
  tbb.MAR_SUCC as MAR_SUCC,
  tbb.INIT_REGISTER_FAIL_ALL as INIT_REGISTER_FAIL_ALL,
  tbb.INIT_REGFAIL_IMS as INIT_REGFAIL_IMS,
  tbb.INIT_REGFAIL_CS as INIT_REGFAIL_CS,
  tbb.INIT_REGFAIL_EPC as INIT_REGFAIL_EPC,
  tbb.INIT_REGFAIL_RAD as INIT_REGFAIL_RAD,
  tbb.INIT_REGFAIL_RAD_CXTREL as INIT_REGFAIL_RAD_CXTREL,
  tbb.INIT_REGFAIL_RAD_ERABREL as INIT_REGFAIL_RAD_ERABREL,
  tbb.INIT_REGFAIL_RAD_UE as INIT_REGFAIL_RAD_UE,
  (tbb.INIT_REGISTER_FAIL_ALL-tbb.INIT_REGFAIL_IMS-tbb.INIT_REGFAIL_CS-tbb.INIT_REGFAIL_EPC-tbb.INIT_REGFAIL_RAD-tbb.INIT_REGFAIL_RAD_UE) as INIT_REGFAIL_OTHER,
  tbb.INIT_REGFAIL_IMS_EXPIRY as INIT_REGFAIL_IMS_EXPIRY,
  tbb.INIT_REGFAIL_CS_EXPIRY as INIT_REGFAIL_CS_EXPIRY,
  tbb.INIT_REGFAIL_EPC_EXPIRY as INIT_REGFAIL_EPC_EXPIRY,
  tbb.INIT_REGFAIL_RAD_EXPIRY as INIT_REGFAIL_RAD_EXPIRY,
  tbb.CALLSETUP_ATTEMPT as CALLSETUP_ATTEMPT,
  tbb.CALLSETUP_A_ATTEMPT as CALLSETUP_A_ATTEMPT,
  tbb.CALLSETUP_V_ATTEMPT as CALLSETUP_V_ATTEMPT,
  tbb.CALLSETUP_MO_ATTEMPT as CALLSETUP_MO_ATTEMPT,
  tbb.CALLSETUP_A_MO_ATTEMPT as CALLSETUP_A_MO_ATTEMPT,
  tbb.CALLSETUP_V_MO_ATTEMPT as CALLSETUP_V_MO_ATTEMPT,
  tbb.CALLSETUP_MT_ATTEMPT as CALLSETUP_MT_ATTEMPT,
  tbb.CALLSETUP_A_MT_ATTEMPT as CALLSETUP_A_MT_ATTEMPT,
  tbb.CALLSETUP_V_MT_ATTEMPT as CALLSETUP_V_MT_ATTEMPT,
  tbb.CALLSETUP_SUCC as CALLSETUP_SUCC,
  tbb.CALLSETUP_A_SUCC as CALLSETUP_A_SUCC,
  tbb.CALLSETUP_V_SUCC as CALLSETUP_V_SUCC,
  tbb.CALLSETUP_LATENCY_ALL as CALLSETUP_LATENCY_ALL,
  tbb.CALLSETUP_A_LATENCY_ALL as CALLSETUP_A_LATENCY_ALL,
  tbb.CALLSETUP_V_LATENCY_ALL as CALLSETUP_V_LATENCY_ALL,
  tbb.CALLSETUP_A_SUCC_SBC as CALLSETUP_A_SUCC_SBC,
  tbb.CALLSETUP_A_SUCC_SCSCF as CALLSETUP_A_SUCC_SCSCF,
  tbb.CALLSETUP_A_SUCC_AS as CALLSETUP_A_SUCC_AS,
  tbb.CALLSETUP_A_SUCC_MGCF as CALLSETUP_A_SUCC_MGCF,
  tbb.CALLSETUP_A_MO_SUC_SBC_LAT_ALL as CALLSETUP_A_MO_SUC_SBC_LAT_ALL,
  tbb.CALLSETUP_A_MO_SUC_SCS_LAT_ALL as CALLSETUP_A_MO_SUC_SCS_LAT_ALL,
  tbb.CALLSETUP_A_MO_SUC_AS_LAT_ALL as CALLSETUP_A_MO_SUC_AS_LAT_ALL,
  tbb.CALLSETUP_A_MO_SUC_MG_LAT_ALL as CALLSETUP_A_MO_SUC_MG_LAT_ALL,
  tbb.CALLSETUP_MO_SUCC as CALLSETUP_MO_SUCC,
  tbb.CALLSETUP_MO_LATENCY_ALL as CALLSETUP_MO_LATENCY_ALL,
  tbb.CALLSETUP_A_MO_SUCC as CALLSETUP_A_MO_SUCC,
  tbb.CALLSETUP_A_MO_LATENCY_ALL as CALLSETUP_A_MO_LATENCY_ALL,
  tbb.CALLSETUP_V_MO_SUCC as CALLSETUP_V_MO_SUCC,
  tbb.CALLSETUP_V_MO_LATENCY_ALL as CALLSETUP_V_MO_LATENCY_ALL,
  tbb.CALLSETUP_MT_SUCC as CALLSETUP_MT_SUCC,
  tbb.CALLSETUP_MT_LATENCY_ALL as CALLSETUP_MT_LATENCY_ALL,
  tbb.CALLSETUP_A_MT_SUCC as CALLSETUP_A_MT_SUCC,
  tbb.CALLSETUP_A_MT_LATENCY_ALL as CALLSETUP_A_MT_LATENCY_ALL,
  tbb.CALLSETUP_V_MT_SUCC as CALLSETUP_V_MT_SUCC,
  tbb.CALLSETUP_V_MT_LATENCY_ALL as CALLSETUP_V_MT_LATENCY_ALL,
  tbb.CALL_ANS_SUCC as CALL_ANS_SUCC,
  tbb.CALL_ANS_A_SUCC as CALL_ANS_A_SUCC,
  tbb.CALL_ANS_V_SUCC as CALL_ANS_V_SUCC,
  tbb.CALL_ANS_MO_SUCC as CALL_ANS_MO_SUCC,
  tbb.CALL_ANS_A_MO_SUCC as CALL_ANS_A_MO_SUCC,
  tbb.CALL_ANS_V_MO_SUCC as CALL_ANS_V_MO_SUCC,
  tbb.CALL_ANS_MT_SUCC as CALL_ANS_MT_SUCC,
  tbb.CALL_ANS_A_MT_SUCC as CALL_ANS_A_MT_SUCC,
  tbb.CALL_ANS_V_MT_SUCC as CALL_ANS_V_MT_SUCC,
  tbb.CALL_ANS_MO_LATENCY_ALL as CALL_ANS_MO_LATENCY_ALL,
  tbb.CALL_ANS_A_MO_LATENCY_ALL as CALL_ANS_A_MO_LATENCY_ALL,
  tbb.CALL_ANS_V_MO_LATENCY_ALL as CALL_ANS_V_MO_LATENCY_ALL,
  tbb.CALL_ANS_MT_LATENCY_ALL as CALL_ANS_MT_LATENCY_ALL,
  tbb.CALL_ANS_A_MT_LATENCY_ALL as CALL_ANS_A_MT_LATENCY_ALL,
  tbb.CALL_ANS_V_MT_LATENCY_ALL as CALL_ANS_V_MT_LATENCY_ALL,
  tbb.CALL_DURATION as CALL_DURATION,
  tbb.CALL_DURATION_A as CALL_DURATION_A,
  tbb.CALL_DURATION_V as CALL_DURATION_V,
  tbb.CALL_DURATION_MO as CALL_DURATION_MO,
  tbb.CALL_DURATION_A_MO as CALL_DURATION_A_MO,
  tbb.CALL_DURATION_V_MO as CALL_DURATION_V_MO,
  tbb.CALL_DURATION_MT as CALL_DURATION_MT,
  tbb.CALL_DURATION_A_MT as CALL_DURATION_A_MT,
  tbb.CALL_DURATION_V_MT as CALL_DURATION_V_MT,
  tbb.CALLSETUP_FAIL_MO_ALL as CALLSETUP_FAIL_MO_ALL,
  tbb.CALLSETUP_FAIL_MT_ALL as CALLSETUP_FAIL_MT_ALL,
  tbb.CALLSETUP_FAIL_MO_IMS_INCLUS as CALLSETUP_FAIL_MO_IMS_INCLUS,
  tbb.CALLSETUP_FAIL_MO_CS_INCLUS as CALLSETUP_FAIL_MO_CS_INCLUS,
  tbb.CALLSETUP_FAIL_MO_EPC as CALLSETUP_FAIL_MO_EPC,
  (tbb.CALL_SETUP_FAIL_MO_RAD_CTXREL+tbb.CALL_SETUP_FAIL_MO_RAD_ERABREL+tbb.CALL_SETUP_FAIL_MO_RAD_BSRVCC) as CALLSETUP_FAIL_MO_RAD,
  tbb.CALLSETUP_FAIL_MO_RAD_CTXREL as CALLSETUP_FAIL_MO_RAD_CTXREL,
  tbb.CALLSETUP_FAIL_MO_RAD_ERABREL as CALLSETUP_FAIL_MO_RAD_ERABREL,
  tbb.CALLSETUP_FAIL_MO_RAD_BSRVCC as CALLSETUP_FAIL_MO_RAD_BSRVCC,
  (tbb.CALL_SETUP_FAIL_MO_USBUSY+tbb.CALL_SETUP_FAIL_MO_USEARLY+tbb.CALL_SETUP_FAIL_MO_USNORSP+tbb.CALL_SETUP_FAIL_MO_USWRONG) as CALLSETUP_FAIL_MO_USER,
  tbb.CALLSETUP_FAIL_MO_USBUSY as CALLSETUP_FAIL_MO_USBUSY,
  tbb.CALLSETUP_FAIL_MO_IMS_USBUSY as CALLSETUP_FAIL_MO_IMS_USBUSY,
  tbb.CALLSETUP_FAIL_MO_CS_USBUSY as CALLSETUP_FAIL_MO_CS_USBUSY,
  tbb.CALLSETUP_FAIL_MO_USEARLY as CALLSETUP_FAIL_MO_USEARLY,
  tbb.CALLSETUP_FAIL_MO_IMS_USEARLY as CALLSETUP_FAIL_MO_IMS_USEARLY,
  tbb.CALLSETUP_FAIL_MO_CS_USEARLY as CALLSETUP_FAIL_MO_CS_USEARLY,
  tbb.CALLSETUP_FAIL_MO_USNORSP as CALLSETUP_FAIL_MO_USNORSP,
  tbb.CALLSETUP_FAIL_MO_IMS_USNORSP as CALLSETUP_FAIL_MO_IMS_USNORSP,
  tbb.CALLSETUP_FAIL_MO_CS_USNORSP as CALLSETUP_FAIL_MO_CS_USNORSP,
  tbb.CALLSETUP_FAIL_MO_USWRONG as CALLSETUP_FAIL_MO_USWRONG,
  tbb.CALLSETUP_FAIL_MO_IMS_USWRONG as CALLSETUP_FAIL_MO_IMS_USWRONG,
  tbb.CALLSETUP_FAIL_MO_CS_USWRONG as CALLSETUP_FAIL_MO_CS_USWRONG,
  tbb.CALLSETUP_FAIL_MO_RAD_UE as CALLSETUP_FAIL_MO_RAD_UE,
  tbb.CALLSETUP_FAIL_MO_RAD_UE_NANS as CALLSETUP_FAIL_MO_RAD_UE_NANS,
  tbb.CALLSETUP_FAIL_MO_RAD_UE_AB as CALLSETUP_FAIL_MO_RAD_UE_AB,
  (tbb.CALL_SETUP_FAIL_MO_ALL-(tbb.CALL_SETUP_FAIL_MO_IMS_INCLUS-tbb.CALL_SETUP_FAIL_MO_IMS_USBUSY-tbb.CALL_SETUP_FAIL_MO_IMS_USEARLY-tbb.CALL_SETUP_FAIL_MO_IMS_USNORSP-tbb.CALL_SETUP_FAIL_MO_IMS_USWRONG)-(tbb.CALL_SETUP_FAIL_MO_CS_INCLUS-tbb.CALL_SETUP_FAIL_MO_CS_USBUSY-tbb.CALL_SETUP_FAIL_MO_CS_USEARLY-tbb.CALL_SETUP_FAIL_MO_CS_USNORSP-tbb.CALL_SETUP_FAIL_MO_CS_USWRONG)-tbb.CALL_SETUP_FAIL_MO_EPC-tbb.CALL_SETUP_FAIL_MO_RAD-tbb.CALL_SETUP_FAIL_MO_RAD_UE-tbb.CALL_SETUP_FAIL_MO_USER) as CALLSETUP_FAIL_MO_OTHER,
  tbb.CALLSETUP_FAIL_MT_IMS_INCLUS as CALLSETUP_FAIL_MT_IMS_INCLUS,
  tbb.CALLSETUP_FAIL_MT_CS_INCLUS as CALLSETUP_FAIL_MT_CS_INCLUS,
  tbb.CALLSETUP_FAIL_MT_EPC as CALLSETUP_FAIL_MT_EPC,
  (tbb.CALL_SETUP_FAIL_MT_RAD_CTXREL+tbb.CALL_SETUP_FAIL_MT_RAD_ERABREL+tbb.CALL_SETUP_FAIL_MT_RAD_BSRVCC) as CALLSETUP_FAIL_MT_RAD,
  tbb.CALLSETUP_FAIL_MT_RAD_CTXREL as CALLSETUP_FAIL_MT_RAD_CTXREL,
  tbb.CALLSETUP_FAIL_MT_RAD_ERABREL as CALLSETUP_FAIL_MT_RAD_ERABREL,
  tbb.CALLSETUP_FAIL_MT_RAD_BSRVCC as CALLSETUP_FAIL_MT_RAD_BSRVCC,
  (tbb.CALL_SETUP_FAIL_MT_USBUSY+tbb.CALL_SETUP_FAIL_MT_USEARLY+tbb.CALL_SETUP_FAIL_MT_USNORSP) as CALLSETUP_FAIL_MT_USER,
  tbb.CALLSETUP_FAIL_MT_USBUSY as CALLSETUP_FAIL_MT_USBUSY,
  tbb.CALLSETUP_FAIL_MT_IMS_USBUSY as CALLSETUP_FAIL_MT_IMS_USBUSY,
  tbb.CALLSETUP_FAIL_MT_CS_USBUSY as CALLSETUP_FAIL_MT_CS_USBUSY,
  tbb.CALLSETUP_FAIL_MT_USEARLY as CALLSETUP_FAIL_MT_USEARLY,
  tbb.CALLSETUP_FAIL_MT_IMS_USEARLY as CALLSETUP_FAIL_MT_IMS_USEARLY,
  tbb.CALLSETUP_FAIL_MT_CS_USEARLY as CALLSETUP_FAIL_MT_CS_USEARLY,
  tbb.CALLSETUP_FAIL_MT_USNORSP as CALLSETUP_FAIL_MT_USNORSP,
  tbb.CALLSETUP_FAIL_MT_IMS_USNORSP as CALLSETUP_FAIL_MT_IMS_USNORSP,
  tbb.CALLSETUP_FAIL_MT_CS_USNORSP as CALLSETUP_FAIL_MT_CS_USNORSP,
  tbb.CALLSETUP_FAIL_MT_RAD_UE as CALLSETUP_FAIL_MT_RAD_UE,
  tbb.CALLSETUP_FAIL_MT_RAD_UE_NANS as CALLSETUP_FAIL_MT_RAD_UE_NANS,
  tbb.CALLSETUP_FAIL_MT_RAD_UE_AB as CALLSETUP_FAIL_MT_RAD_UE_AB,
  (tbb.CALL_SETUP_FAIL_MT_ALL-(tbb.CALL_SETUP_FAIL_MT_IMS_INCLUS-tbb.CALL_SETUP_FAIL_MT_IMS_USBUSY-tbb.CALL_SETUP_FAIL_MT_IMS_USEARLY-tbb.CALL_SETUP_FAIL_MT_IMS_USNORSP)-(tbb.CALL_SETUP_FAIL_MT_CS_INCLUS-tbb.CALL_SETUP_FAIL_MT_CS_USBUSY-tbb.CALL_SETUP_FAIL_MT_CS_USEARLY-tbb.CALL_SETUP_FAIL_MT_CS_USNORSP)-tbb.CALL_SETUP_FAIL_MT_EPC-tbb.CALL_SETUP_FAIL_MT_RAD-tbb.CALL_SETUP_FAIL_MT_RAD_UE-tbb.CALL_SETUP_FAIL_MT_USER) as CALLSETUP_FAIL_MT_OTHER,
  tbb.CALLSETUP_FAIL_MO_TEXPIRY_IMS as CALLSETUP_FAIL_MO_TEXPIRY_IMS,
  tbb.CALLSETUP_FAIL_MT_TEXPIRY_IMS as CALLSETUP_FAIL_MT_TEXPIRY_IMS,
  tbb.CALLSETUP_FAIL_MO_TEXPIRY_CS as CALLSETUP_FAIL_MO_TEXPIRY_CS,
  tbb.CALLSETUP_FAIL_MT_TEXPIRY_CS as CALLSETUP_FAIL_MT_TEXPIRY_CS,
  tbb.CALLSETUP_FAIL_MO_TEXPIRY_EPC as CALLSETUP_FAIL_MO_TEXPIRY_EPC,
  tbb.CALLSETUP_FAIL_MT_TEXPIRY_EPC as CALLSETUP_FAIL_MT_TEXPIRY_EPC,
  tbb.CALLSETUP_FAIL_MO_TEXPIRY_RAD as CALLSETUP_FAIL_MO_TEXPIRY_RAD,
  tbb.CALLSETUP_FAIL_MT_TEXPIRY_RAD as CALLSETUP_FAIL_MT_TEXPIRY_RAD,
  tbb.CALLSETUP_ATTEMP_VT10086 as CALLSETUP_ATTEMP_VT10086,
  tbb.CALLSETUP_SUC_VT10086 as CALLSETUP_SUC_VT10086,
  tbb.CALLSETUP_VT10086_LATENCY_ALL as CALLSETUP_VT10086_LATENCY_ALL
FROM
(select
  sum(case when b.Procedure_Type=1 then 1 else null end) as INITIAL_REGISTER_ATTEMPT,
  sum(case when b.Procedure_Type=1 and b.Flow_Status=1 then 1 else null end) as INITIAL_REGISTER_SUCC,
  sum(case when b.Procedure_Type=1 and b.Flow_Status=1 then b.FLOW_ENDTIME-b.FLOW_STARTTIME end) as INITIAL_REGISTER_LATENCY_ALL,
  sum(case when b.Procedure_Type=9 then 1 else null end) as RE_REGISTER_ATTEMPT,
  sum(case when b.Procedure_Type=9 and b.Flow_Status=1 then 1 else null end) as RE_REGISTER_SUCC,

  sum(case when b.Procedure_Type=9 and b.Flow_Status=1 then b.FLOW_ENDTIME-b.FLOW_STARTTIME end) as INITIAL_REGISTER_ATTEMPT,
  sum(case when b.Procedure_Type in(1,9) then 1 else null end) as INITIAL_REGISTER_ATTEMPT,
  sum(case when b.Procedure_Type in(1,9) and b.Flow_Status=1 then 1 else null end) as INITIAL_REGISTER_ATTEMPT,
  sum(case when b.Procedure_Type in(1,9) and b.Flow_Status=1 then b.FLOW_ENDTIME-b.FLOW_STARTTIME end) as INITIAL_REGISTER_ATTEMPT,
  sum(case when b.Procedure_Type=2 then 1 else null end) as INITIAL_REGISTER_ATTEMPT,

  sum(case when b.Procedure_Type=2 and b.Flow_Status=1 then 1 else null end) as DEREGISTER_SUCC,
  sum(case when b.Procedure_Type=2 and b.Flow_Status=1 then b.FLOW_ENDTIME-b.FLOW_STARTTIME end) as DEREGISTER_LATENCY_ALL,
  sum(case when b.Procedure_Type=1 and b.S1U_Flow_Status>0 and b.S1U_Flow_Status <> 4294967295 then 1 else null end) as SBC_REGISTER_SUCC_ATTEMPT,
  sum(case when b.Procedure_Type=1 and b.S1U_Flow_Status=1 then 1 else null end) as SBC_REGISTER_SUCC,
  sum(case when b.Procedure_Type=1 and b.Mw_Flow_Status>0 and b.Mw_Flow_Status <> 4294967295 then 1 else null end) as SCSCF_REGISTER_SUCC_ATTEMPT,

  sum(case when b.Procedure_Type=1 and b.Mw_Flow_Status=1 then 1 else null end) as SCSCF_REGISTER_SUCC,
  sum(case when b.Procedure_Type=1 and b.CX_MAR_XDRID>0 then 1 else null end) as MAR_ATTEMPT,
  sum(case when b.Procedure_Type=1 and b.CX_MAR_XDRID>0 and b.CX_MAR_TRANSACTION_STATUS=1 then 1 else null end) as MAR_SUCC,
  sum(CASE WHEN b.Procedure_Type=1 AND b.Flow_Status=2 THEN 1 else null END) AS INIT_REGISTER_FAIL_ALL,
  sum(case when b.Procedure_Type=1 and b.Flow_Status IN (2,4) and b.Flow_FIRFAIL_Interface IN (0,1,8) and b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF') and (b.FLOW_FIRFAIL_RESPONSECODE NOT IN (400,401,408,500,403,404,421,503) OR b.FLOW_FIRFAIL_RESPONSECODE IS NULL) then 1 else null end) as INIT_REGFAIL_IMS,

  sum(case when b.Procedure_Type=1  and b.Flow_Status IN (2,4) and b.Flow_FIRFAIL_Interface=8  and b.FLOW_FIRFAIL_NETYPE= 'HSS' then 1 else null end) as INIT_REGFAIL_CS,
  sum(case when b.Procedure_Type=1  and b.Flow_Status IN (2,4) and b.Flow_FIRFAIL_Interface IN (9,10,13) and b.FLOW_FIRFAIL_NETYPE IN( 'MME', 'SPGW' ,'PCRF') then 1 else null end) as INIT_REGFAIL_EPC,
  sum(case when b.Procedure_Type=1  and b.Flow_Status IN (2,4) and b.Flow_FIRFAIL_Interface=13 and b.FLOW_FIRFAIL_NETYPE<> 'MME'  and ((b.S1MME_FF_ProcedureType=20  and b.S1MME_FF_Keyword1=1) or (b.S1MME_FF_ProcedureType=21  and b.S1MME_FF_Keyword1=1)) then 1 else null end) as INIT_REGFAIL_RAD,
  sum(case when b.Procedure_Type=1  and b.Flow_Status IN (2,4) and b.Flow_FIRFAIL_Interface=13 and b.FLOW_FIRFAIL_NETYPE<> 'MME'  and (b.S1MME_FF_ProcedureType=20  and b.S1MME_FF_Keyword1=1) then 1 else null end) as INIT_REGFAIL_RAD_CXTREL,
  sum(case when b.Procedure_Type=1  and b.Flow_Status IN (2,4) and b.Flow_FIRFAIL_Interface=13 and b.FLOW_FIRFAIL_NETYPE<> 'MME'    and (b.S1MME_FF_ProcedureType=21  and b.S1MME_FF_Keyword1=1) then 1 else null end) as INIT_REGFAIL_RAD_ERABREL,

  sum(CASE WHEN (b.Procedure_Type=1 AND (b.Flow_Status=2 AND b.Flow_FIRFAIL_Interface IN (0,1,8) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF') OR b.FLOW_FIRFAIL_NETYPE IS NULL) AND b.FLOW_FIRFAIL_RESPONSECODE IN (400,401,408,500,403,404,421,503)) OR (b.Procedure_Type=1 AND b.Flow_Status=4 AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<> 'MME'AND ((b.S1MME_FF_ProcedureType<>20 OR b.S1MME_FF_Keyword1<>1) AND (b.S1MME_FF_ProcedureType<>21 OR b.S1MME_FF_Keyword1<>1))) THEN 1 ELSE NULL END) AS INIT_REGFAIL_RAD_UE,
  --(INIT_REGISTER_FAIL_ALL-INIT_REGFAIL_IMS-INIT_REGFAIL_CS-INIT_REGFAIL_EPC-INIT_REGFAIL_RAD-INIT_REGFAIL_RAD_UE) as INIT_REGFAIL_OTHER,
  sum(case when b.Procedure_Type=1  and b.Flow_Status=4 and b.Flow_FIRFAIL_Interface IN(0,1,8) and b.FLOW_FIRFAIL_NETYPE IN('SBC','IS_CSCF') then 1 else null end) as INIT_REGFAIL_IMS_EXPIRY,
  sum(case when b.Procedure_Type=1  and b.Flow_Status=4 and b.Flow_FIRFAIL_Interface=8 and b.FLOW_FIRFAIL_NETYPE='HSS' then 1 else null end) as INIT_REGFAIL_CS_EXPIRY,
  sum(case when b.Procedure_Type=1  and b.Flow_Status=4 and b.Flow_FIRFAIL_Interface IN(9,10,13) and b.FLOW_FIRFAIL_NETYPE IN('MME', 'SPGW' ,'PCRF') then 1 else null end) as INIT_REGFAIL_EPC_EXPIRY,

  sum(case when b.Procedure_Type=1  and b.Flow_Status=4 and b.Flow_FIRFAIL_Interface=13 and b.FLOW_FIRFAIL_NETYPE<> 'MME'  and b.FLOW_FIRFAIL_RESPONSECODE<>401 then 1 else null end) as INIT_REGFAIL_RAD_EXPIRY,
  sum(case when b.Procedure_Type=5 then 1 else null end) as CALLSETUP_ATTEMPT,
  sum(case when b.Procedure_Type=5 and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_ATTEMPT,
  sum(case when b.Procedure_Type=5 and b.Service_Type=2 then 1 else null end) as CALLSETUP_V_ATTEMPT,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 then 1 else null end) as CALLSETUP_MO_ATTEMPT,

  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_MO_ATTEMPT,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Service_Type=2 then 1 else null end) as CALLSETUP_V_MO_ATTEMPT,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=2 then 1 else null end) as CALLSETUP_MT_ATTEMPT,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=2 and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_MT_ATTEMPT,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=2 and b.Service_Type=2 then 1 else null end) as CALLSETUP_V_MT_ATTEMPT,

  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) then 1 else null end) as CALLSETUP_SUCC,
  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_SUCC,
  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) and b.Service_Type=2 then 1 else null end) as CALLSETUP_V_SUCC,
  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_LATENCY_ALL,
  sum(case when b.Procedure_Type=5 and b.Service_Type=1 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_A_LATENCY_ALL,
  sum(case when b.Procedure_Type=5 and b.Service_Type=2 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_V_LATENCY_ALL,

  sum(case when b.Procedure_Type=5 and (b.S1U_ALERTING_TIME>0 OR b.S1U_ANSWER_TIME>0) and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_SUCC_SBC,
  sum(case when b.Procedure_Type=5 and (b.MW_ALERTING_TIME>0 OR  b.MW_ANSWER_TIME>0) and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_SUCC_SCSCF,
  sum(case when b.Procedure_Type=5 and (b.ISC_ALERTING_TIME>0 OR b.ISC_ANSWER_TIME>0) and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_SUCC_AS,
  sum(case when b.Procedure_Type=5 and (b.MG_ALERTING_TIME>0 OR  b.MG_ANSWER_TIME>0) and b.Service_Type=1 then 1 else null end) as CALLSETUP_A_SUCC_MGCF,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and (b.S1U_ALERTING_TIME>0 or ((b.S1U_ALERTING_TIME=0 OR b.S1U_ALERTING_TIME IS NULL) and b.S1U_ANSWER_TIME>0)) then (case when b.S1U_ALERTING_TIME>0 then b.S1U_ALERTING_TIME ELSE b.S1U_ANSWER_TIME end) end) as CALLSETUP_A_MO_SUC_SBC_LAT_ALL,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and (b.MW_ALERTING_TIME>0 or ((b.MW_ALERTING_TIME=0 OR b.MW_ALERTING_TIME IS NULL) and b.MW_ANSWER_TIME>0)) then (case when b.MW_ALERTING_TIME>0 then b.MW_ALERTING_TIME ELSE b.MW_ANSWER_TIME end) end) as CALLSETUP_A_MO_SUC_SCS_LAT_ALL,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and (b.ISC_ALERTING_TIME>0 or ((b.ISC_ALERTING_TIME=0 OR b.ISC_ALERTING_TIME IS NULL) and b.ISC_ANSWER_TIME>0)) then (case when b.ISC_ALERTING_TIME>0 then b.ISC_ALERTING_TIME ELSE b.ISC_ANSWER_TIME end) end) as CALLSETUP_A_MO_SUC_AS_LAT_ALL,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and (b.MG_ALERTING_TIME>0 or ((b.MG_ALERTING_TIME=0 OR b.MG_ALERTING_TIME IS NULL) and b.MG_ANSWER_TIME>0)) then (case when b.MG_ALERTING_TIME>0 then b.MG_ALERTING_TIME ELSE b.MG_ANSWER_TIME end) end) as CALLSETUP_A_MO_SUC_MG_LAT_ALL,
  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) and b.CALL_SIDE=1 then 1 else null end) as CALLSETUP_MO_SUCC,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_MO_LATENCY_ALL,

  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) and b.Service_Type=1 and b.CALL_SIDE=1 then 1 else null end) as CALLSETUP_A_MO_SUCC,
  sum(case when b.Procedure_Type=5 and b.Service_Type=1 and b.CALL_SIDE=1 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_A_MO_LATENCY_ALL,
  sum(case when b.Procedure_Type=5 and b.ALERTING_TIME>0 and b.Service_Type=2 and b.CALL_SIDE=1 then 1 else null end) as CALLSETUP_V_MO_SUCC,
  sum(case when b.Procedure_Type=5 and b.Service_Type=2 and b.CALL_SIDE=1 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_V_MO_LATENCY_ALL,
  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) and b.CALL_SIDE=2 then 1 else null end) as CALLSETUP_MT_SUCC,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=2 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_MT_LATENCY_ALL,
  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) and b.Service_Type=1 and b.CALL_SIDE=2 then 1 else null end) as CALLSETUP_A_MT_SUCC,
  sum(case when b.Procedure_Type=5 and b.Service_Type=1 and b.CALL_SIDE=2 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_A_MT_LATENCY_ALL,
  sum(case when b.Procedure_Type=5 and (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) and b.Service_Type=2 and b.CALL_SIDE=2 then 1 else null end) as CALLSETUP_V_MT_SUCC,
  sum(case when b.Procedure_Type=5 and b.Service_Type=2 and b.CALL_SIDE=2 and (b.ALERTING_TIME>0 or ((b.ALERTING_TIME=0 OR b.ALERTING_TIME IS NULL) and b.ANSWER_TIME>0)) then (case when b.ALERTING_TIME>0 then b.ALERTING_TIME ELSE b.ANSWER_TIME end) end) as CALLSETUP_V_MT_LATENCY_ALL,

  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 then 1 else null end) as CALL_ANS_SUCC,
  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 and b.Service_Type=1 then 1 else null end) as CALL_ANS_A_SUCC,
  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 and b.Service_Type=2 then 1 else null end) as CALL_ANS_V_SUCC,
  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 and b.CALL_SIDE=1 then 1 else null end) as CALL_ANS_MO_SUCC,
  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 and b.CALL_SIDE=1 and b.Service_Type=1 then 1 else null end) as CALL_ANS_A_MO_SUCC,
  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 and b.CALL_SIDE=1 and b.Service_Type=2 then 1 else null end) as CALL_ANS_V_MO_SUCC,
  sum(CASE WHEN b.Procedure_Type=5 AND b.ANSWER_TIME>0 AND b.CALL_SIDE=2 THEN 1 ELSE NULL END) AS CALL_ANS_MT_SUCC,
  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 and b.CALL_SIDE=2 and b.Service_Type=1 then 1 else null end) as CALL_ANS_A_MT_SUCC,
  sum(case when b.Procedure_Type=5 and b.ANSWER_TIME>0 and b.CALL_SIDE=2 and b.Service_Type=2 then 1 else null end) as CALL_ANS_V_MT_SUCC,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.ANSWER_TIME>0 then b.ANSWER_TIME end) as CALL_ANS_MO_LATENCY_ALL,

  sum(case when b.Procedure_Type=5  and b.CALL_SIDE=1 and b.Service_Type=1 and b.ANSWER_TIME>0 then b.ANSWER_TIME end) as CALL_ANS_A_MO_LATENCY_ALL,
  sum(case when b.Procedure_Type=5  and b.CALL_SIDE=1 and b.Service_Type=2 and b.ANSWER_TIME>0 then b.ANSWER_TIME end) as CALL_ANS_V_MO_LATENCY_ALL,
  sum(case when b.Procedure_Type=5  and b.CALL_SIDE=2 and b.ANSWER_TIME>0 then b.ANSWER_TIME end) as CALL_ANS_MT_LATENCY_ALL,
  sum(case when b.Procedure_Type=5  and b.CALL_SIDE=2 and b.Service_Type=1 and b.ANSWER_TIME>0 then b.ANSWER_TIME end) as CALL_ANS_A_MT_LATENCY_ALL,
  sum(case when b.Procedure_Type=5  and b.CALL_SIDE=2 and b.Service_Type=2 and b.ANSWER_TIME>0 then b.ANSWER_TIME end) as CALL_ANS_V_MT_LATENCY_ALL,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0  then b.CALL_DURATION end) as CALL_DURATION,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.Service_Type=1 then b.CALL_DURATION end) as CALL_DURATION_A,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.Service_Type=2 then b.CALL_DURATION end) as CALL_DURATION_V,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.CALL_SIDE=1  then b.CALL_DURATION end) as CALL_DURATION_MO,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.CALL_SIDE=1 and b.SERIVCE_TYPE=1 then b.CALL_DURATION end) as CALL_DURATION_A_MO,

  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.CALL_SIDE=1 and b.SERIVCE_TYPE=2 then b.CALL_DURATION end) as CALL_DURATION_V_MO,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.CALL_SIDE=2  then b.CALL_DURATION end) as CALL_DURATION_MT,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.CALL_SIDE=2 and b.SERIVCE_TYPE=1 then b.CALL_DURATION end) as CALL_DURATION_A_MT,
  sum(case when b.Procedure_Type=5  and b.ANSWER_TIME>0 and b.CALL_DURATION>0 and b.CALL_SIDE=2 and b.SERIVCE_TYPE=2 then b.CALL_DURATION end) as CALL_DURATION_V_MT,
  sum(case when (b.Procedure_Type=5  and b.Flow_Status IN (2,3,4) and b.CALL_SIDE=1) OR (b.Procedure_Type=5  and b.CALL_SIDE=1 and b.Flow_Status=5 and b.SV_FLAG=2) then 1 else null end) as CALLSETUP_FAIL_MO_ALL,
  sum(case when (b.Procedure_Type=5  and b.Flow_Status IN (2,3,4) and b.CALL_SIDE=2) OR (b.Procedure_Type=5  and b.CALL_SIDE=1 and b.Flow_Status=5 and b.SV_FLAG=2) then 1 else null end) as CALLSETUP_FAIL_MT_ALL,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3,4) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR (Flow_FIRFAIL_Interface IN (1,2))) AND (b.FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403) OR b.FLOW_FIRFAIL_RESPONSECODE IS NULL) THEN 1 ELSE NULL END) AS CALLSETUP_FAIL_MO_IMS_INCLUS,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and (b.Flow_Status IN (2,3,4) and b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) and b.FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS') and (b.FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403) or b.FLOW_FIRFAIL_RESPONSECODE is NULL)) then 1 else null end) as CALLSETUP_FAIL_MO_CS_INCLUS,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Flow_Status IN (2,3,4) and b.Flow_FIRFAIL_Interface IN (9,10,13) and b.FLOW_FIRFAIL_NETYPE IN ('MME', 'SPGW', 'PCRF') then 1 else null end) as CALLSETUP_FAIL_MO_EPC,
  --(CALL_SETUP_FAIL_MO_RAD_CTXREL+CALL_SETUP_FAIL_MO_RAD_ERABREL+CALL_SETUP_FAIL_MO_RAD_BSRVCC) as CALLSETUP_FAIL_MO_RAD

  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Flow_Status IN (2,3,4) and b.Flow_FIRFAIL_Interface=13 and b.FLOW_FIRFAIL_NETYPE<>'MME' and (b.S1MME_FF_ProcedureType=20  and b.S1MME_FF_Keyword1=1) then 1 else null end) as CALLSETUP_FAIL_MO_RAD_CTXREL,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Flow_Status IN (2,3,4) and b.Flow_FIRFAIL_Interface=13 and b.FLOW_FIRFAIL_NETYPE<>'MME' and (b.S1MME_FF_ProcedureType=21  and b.S1MME_FF_Keyword1=1) then 1 else null end) as CALLSETUP_FAIL_MO_RAD_ERABREL,
  sum(case when b.Procedure_Type=5 and b.Flow_Status=5 and b.CALL_SIDE=1 and b.SV_FLAG=2 then 1 else null end) as CALLSETUP_FAIL_MO_RAD_BSRVCC,
  --(CALL_SETUP_FAIL_MO_USBUSY+CALL_SETUP_FAIL_MO_USEARLY+CALL_SETUP_FAIL_MO_USNORSP+CALL_SETUP_FAIL_MO_USWRONG) as CALLSETUP_FAIL_MO_USER,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Flow_Status IN (2,3) and ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) and b.FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS')) or b.Flow_FIRFAIL_Interface IN (1,2)) and b.FLOW_FIRFAIL_RSPONSECODE=486 then 1 else null end) as CALLSETUP_FAIL_MO_USBUSY,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Flow_Status IN (2,3) and ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) and b.FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS')) or b.Flow_FIRFAIL_Interface IN (1,2)) and b.FLOW_FIRFAIL_RSPONSECODE=486 then 1 else null end) as CALLSETUP_FAIL_MO_IMS_USBUSY,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3) AND b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') AND b.FLOW_FIRFAIL_RSPONSECODE=486 THEN 1 ELSE NULL END) AS CALLSETUP_FAIL_MO_CS_USBUSY,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Flow_Status IN (2,3) and ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) and b.FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS')) or b.Flow_FIRFAIL_Interface IN (1,2)) and b.FLOW_FIRFAIL_TRANSACTION=6  and (b.FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL) then 1 else null end) as CALLSETUP_FAIL_MO_USEARLY,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_TRANSACTION=6 AND (b.FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL) THEN 1 ELSE NULL END) AS CALLSETUP_FAIL_MO_IMS_USEARLY,
  sum(case when b.Procedure_Type=5 and b.CALL_SIDE=1 and b.Flow_Status IN (2,3) and b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) and b.FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS') and b.FLOW_FIRFAIL_TRANSACTION=6  and (b.FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL)  then 1 else null end) as CALLSETUP_FAIL_MO_CS_USEARLY,

  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS','MGCF','HSS')) OR Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_FINISHREASONCAUSE=18 THEN 1 else null END) AS CALLSETUP_FAIL_MO_USNORSP,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_FINISHREASONCAUSE=18 THEN 1 else null END) AS CALLSETUP_FAIL_MO_IMS_USNORSP,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3) AND b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') AND b.FLOW_FIRFAIL_FINISHREASONCAUSE=18 THEN 1 else null END) AS CALLSETUP_FAIL_MO_CS_USNORSP,
  sum(CASE WHEN b.Procedure_Type=5 AND b.Flow_Status IN (2,3) AND b.CALL_SIDE=1 AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS','MGCF','HSS') AND (b.FLOW_FIRFAIL_RSPONSECODE=404 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=1) THEN 1 else null END) AS CALLSETUP_FAIL_MO_USWRONG,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND (b.FLOW_FIRFAIL_RSPONSECODE=404 OR FLOW_FIRFAIL_FINISHREASONCAUSE=1) THEN 1 else null END) AS CALLSETUP_FAIL_MO_IMS_USWRONG,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status IN (2,3) AND b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') AND (b.FLOW_FIRFAIL_RSPONSECODE=404 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=1) THEN 1 else null END) AS CALLSETUP_FAIL_MO_CS_USWRONG,
  sum(CASE WHEN (b.Procedure_Type=5 AND b.CALLCALL_SIDE=1 AND ((b.Flow_Status IN (2,3,4) AND b.S1MME_FF_ProcedureStatus=3 AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<> 'MME'AND ((b.S1MME_FF_ProcedureType<>20 OR b.S1MME_FF_Keyword1<>1) AND (b.S1MME_FF_ProcedureType<>21 OR b.S1MME_FF_Keyword1<>1))) OR (b.Procedure_Type=5 AND b.CALLCALL_SIDE=1 AND b.Flow_Status=2 AND b.Flow_FIRFAIL_Interface IN (0,1,2,3,4,5,7,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS') AND b.FLOW_FIRFAIL_RSPONSECODE IN (503,400,403)))) THEN 1 else null END) AS CALLSETUP_FAIL_MO_RAD_UE,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND ((b.Flow_Status IN (2, 3, 4) AND b.S1MME_FF_ProcedureStatus=3 AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<> 'MME'AND ((b.S1MME_FF_ProcedureType<>20 OR b.S1MME_FF_Keyword1<>1) AND (b.S1MME_FF_ProcedureType<>21 OR b.S1MME_FF_Keyword1<>1)))) THEN 1 else null END) AS CALLSETUP_FAIL_MO_RAD_UE_NANS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status=2 AND b.Flow_FIRFAIL_Interface IN (0,1,2,3,4,5,7,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS') AND b.FLOW_FIRFAIL_RSPONSECODE IN (503,400,403) THEN 1 else null END) AS CALLSETUP_FAIL_MO_RAD_UE_AB,
  --(CALL_SETUP_FAIL_MO_ALL-(CALL_SETUP_FAIL_MO_IMS_INCLUS-CALL_SETUP_FAIL_MO_IMS_USBUSY-CALL_SETUP_FAIL_MO_IMS_USEARLY-CALL_SETUP_FAIL_MO_IMS_USNORSP-CALL_SETUP_FAIL_MO_IMS_USWRONG)-(CALL_SETUP_FAIL_MO_CS_INCLUS-CALL_SETUP_FAIL_MO_CS_USBUSY-CALL_SETUP_FAIL_MO_CS_USEARLY-CALL_SETUP_FAIL_MO_CS_USNORSP-CALL_SETUP_FAIL_MO_CS_USWRONG)-CALL_SETUP_FAIL_MO_EPC-CALL_SETUP_FAIL_MO_RAD-CALL_SETUP_FAIL_MO_RAD_UE-CALL_SETUP_FAIL_MO_USER) AS CALLSETUP_FAIL_MO_OTHER,

  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3,4) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR (b.Flow_FIRFAIL_Interface IN (1,2)) AND (b.FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403) OR b.FLOW_FIRFAIL_RESPONSECODE IS NULL)) THEN 1 else null END) AS CALLSETUP_FAIL_MT_IMS_INCLUS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3,4) AND b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') AND (b.FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403) OR b.FLOW_FIRFAIL_RESPONSECODE IS NULL) THEN 1 else null END) AS CALLSETUP_FAIL_MT_CS_INCLUS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3,4) AND b.Flow_FIRFAIL_Interface IN (9,10,13) AND (b.FLOW_FIRFAIL_NETYPE IN('MME','SPGW','PCRF')) THEN 1 else null END) AS CALLSETUP_FAIL_MT_EPC,
  --(CALL_SETUP_FAIL_MT_RAD_CTXREL+CALL_SETUP_FAIL_MT_RAD_ERABREL+CALL_SETUP_FAIL_MT_RAD_BSRVCC) AS CALLSETUP_FAIL_MT_RAD,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3,4) AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<>'MME'AND (b.S1MME_FF_ProcedureType=20 AND b.S1MME_FF_Keyword1=1) THEN 1 else null END) AS CALLSETUP_FAIL_MT_RAD_CTXREL,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3,4) AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<>'MME'AND (b.S1MME_FF_ProcedureType=21 AND b.S1MME_FF_Keyword1=1) THEN 1 else null END) AS CALLSETUP_FAIL_MT_RAD_ERABREL,
  sum(CASE WHEN b.Procedure_Type=5 AND b.Flow_Status=5 AND b.CALL_SIDE=2 AND b.SV_FLAG=2 THEN 1 else null END) AS CALLSETUP_FAIL_MT_RAD_BSRVCC,
  --(CALL_SETUP_FAIL_MT_USBUSY+CALL_SETUP_FAIL_MT_USEARLY+CALL_SETUP_FAIL_MT_USNORSP) AS CALLSETUP_FAIL_MT_USER,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS','MGCF','HSS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_RSPONSECODE=486 THEN 1 else null END) AS CALLSETUP_FAIL_MT_USBUSY,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_RSPONSECODE=486 THEN 1 else null END) AS CALLSETUP_FAIL_MT_IMS_USBUSY,

  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') AND b.FLOW_FIRFAIL_RSPONSECODE=486 THEN 1 else null END) AS CALLSETUP_FAIL_MT_CS_USBUSY,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS','MGCF','HSS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_TRANSACTION=6 AND (b.FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL) THEN 1 else null END) AS CALLSETUP_FAIL_MT_USEARLY,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_TRANSACTION=6 AND (b.FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL) THEN 1 else null END) AS CALLSETUP_FAIL_MT_IMS_USEARLY,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') AND b.FLOW_FIRFAIL_TRANSACTION=6 AND (b.FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR b.FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL) THEN 1 else null END) AS CALLSETUP_FAIL_MT_CS_USEARLY,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS','MGCF','HSS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_FINISHREASONCAUSE=18 THEN 1 else null END) AS CALLSETUP_FAIL_MT_USNORSP,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND ((b.Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS')) OR b.Flow_FIRFAIL_Interface IN (1,2)) AND b.FLOW_FIRFAIL_FINISHREASONCAUSE=18 THEN 1 else null END) AS CALLSETUP_FAIL_MT_IMS_USNORSP,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status IN (2,3) AND b.Flow_FIRFAIL_Interface IN (3,4,5,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') AND b.FLOW_FIRFAIL_FINISHREASONCAUSE=18 THEN 1 else null END) AS CALLSETUP_FAIL_MT_CS_USNORSP,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALLCALL_SIDE=2 AND ((b.Flow_Status IN (2,3,4) AND b.S1MME_FF_ProcedureStatus=3 AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<> 'MME'AND ((b.S1MME_FF_ProcedureType<>20 AND b.S1MME_FF_Keyword1<>1) AND (b.S1MME_FF_ProcedureType<>21 AND b.S1MME_FF_Keyword1<>1))) OR (b.Procedure_Type=5 AND b.CALLCALL_SIDE=1 AND b.Flow_Status=2 AND b.Flow_FIRFAIL_Interface IN (0, 1, 2, 3, 4, 5, 7, 8, 11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC', 'IS_CSCF', 'AS') AND b.FLOW_FIRFAIL_RSPONSECODE IN (503, 400, 403))) THEN 1 else null END) AS CALLSETUP_FAIL_MT_RAD_UE,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND ((b.Flow_Status IN (2,3,4) AND b.S1MME_FF_ProcedureStatus=3 AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<> 'MME'AND ((b.S1MME_FF_ProcedureType<>20 AND b.S1MME_FF_Keyword1<>1) AND (b.S1MME_FF_ProcedureType<>21 AND b.S1MME_FF_Keyword1<>1)))) THEN 1 else null END) AS CALLSETUP_FAIL_MT_RAD_UE_NANS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status=2 AND b.Flow_FIRFAIL_Interface IN (0,1,2,3,4,5,7,8,11) AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS') AND b.FLOW_FIRFAIL_RSPONSECODE IN (503,400,403) THEN 1 else null END) AS CALLSETUP_FAIL_MT_RAD_UE_AB,

  --(CALL_SETUP_FAIL_MT_ALL-(CALL_SETUP_FAIL_MT_IMS_INCLUS-CALL_SETUP_FAIL_MT_IMS_USBUSY-CALL_SETUP_FAIL_MT_IMS_USEARLY-CALL_SETUP_FAIL_MT_IMS_USNORSP)-(CALL_SETUP_FAIL_MT_CS_INCLUS-CALL_SETUP_FAIL_MT_CS_USBUSY-CALL_SETUP_FAIL_MT_CS_USEARLY-CALL_SETUP_FAIL_MT_CS_USNORSP)-CALL_SETUP_FAIL_MT_EPC-CALL_SETUP_FAIL_MT_RAD-CALL_SETUP_FAIL_MT_RAD_UE-CALL_SETUP_FAIL_MT_USER) AS CALLSETUP_FAIL_MT_OTHER,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_FIRFAIL_Interface IN (0,1,2,3,4,5,7,8,11) AND b.Flow_Status=4 AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS') THEN 1 else null END) AS CALLSETUP_FAIL_MO_TEXPIRY_IMS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_FIRFAIL_Interface IN (0,1,2,3,4,5,7,8,11) AND b.Flow_Status=4 AND b.FLOW_FIRFAIL_NETYPE IN ('SBC','IS_CSCF','AS') THEN 1 else null END) AS CALLSETUP_FAIL_MT_TEXPIRY_IMS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_FIRFAIL_Interface IN (8,11) AND b.Flow_Status=4 AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') THEN 1 else null END) AS CALLSETUP_FAIL_MO_TEXPIRY_CS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_FIRFAIL_Interface IN (8,11) AND b.Flow_Status=4 AND b.FLOW_FIRFAIL_NETYPE IN ('MGCF','HSS') THEN 1 else null END) AS CALLSETUP_FAIL_MT_TEXPIRY_CS,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_FIRFAIL_Interface IN (9,10,13) AND b.Flow_Status=4 AND b.FLOW_FIRFAIL_NETYPE IN ('MME' , 'SPGW' , 'PCRF') THEN 1 ELSE NULL END) AS CALLSETUP_FAIL_MO_TEXPIRY_EPC,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_FIRFAIL_Interface IN (9,10,13) AND b.Flow_Status=4 AND b.FLOW_FIRFAIL_NETYPE IN ('MME' , 'SPGW' , 'PCRF') THEN 1 ELSE NULL END) AS CALLSETUP_FAIL_MT_TEXPIRY_EPC,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=1 AND b.Flow_Status=4 AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<>'MME' THEN 1 else null END) AS CALLSETUP_FAIL_MO_TEXPIRY_RAD,
  sum(CASE WHEN b.Procedure_Type=5 AND b.CALL_SIDE=2 AND b.Flow_Status=4 AND b.Flow_FIRFAIL_Interface=13 AND b.FLOW_FIRFAIL_NETYPE<>'MME' THEN 1 else null END) AS CALLSETUP_FAIL_MT_TEXPIRY_RAD,
  sum(CASE WHEN b.Procedure_TYPE=5 AND b.call_side=1 AND b.CALLED_NUMBER IN (10086,8610086) THEN 1 else null END) AS CALLSETUP_ATTEMP_VT10086,
  sum(CASE WHEN b.Procedure_TYPE=5 AND b.call_side=1 AND (b.ALERTING_TIME>0 OR ANSWER_TIME>0) AND b.CALLED_NUMBER IN (10086,8610086) THEN 1 else null END) AS CALLSETUP_SUC_VT10086,
  sum(CASE WHEN b.Procedure_Type=5 AND (b.ALERTING_TIME>0 OR b.ANSWER_TIME>0) AND b.CALL_SIDE=1 AND b.CALLED_NUMBER IN (10086,8610086) THEN (CASE WHEN b.ALERTING_TIME>0 THEN b.ALERTING_TIME ELSE b.ANSWER_TIME END) END) AS CALLSETUP_VT10086_LATENCY_ALL
from bigxdrcmcc as b) AS ttb;
