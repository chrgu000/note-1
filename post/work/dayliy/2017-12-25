call_setup_a_succ
call_setup_a_attempt
call_setup_fail_mo_user
call_setup_fail_mt_user
call_setup_fail_mo_other
call_setup_fail_mt_other

IF(Procedure_Type=5&&(ALERTING_TIME>0 OR ANSWER_TIME>0)&&Service_Type=1) THEN COUNTER++
IF(Procedure_Type=5&&S1U_Flow_Status>0&&Service_Type=1) THEN COUNTER++ 更新
CALL_SETUP_FAIL_MO_USBUSY+CALL_SETUP_FAIL_MO_USEARLY+CALL_SETUP_FAIL_MO_USNORSP+CALL_SETUP_FAIL_MO_USWRONG
CALL_SETUP_FAIL_MT_USBUSY+CALL_SETUP_FAIL_MT_USEARLY+CALL_SETUP_FAIL_MT_USNORSP


CALL_SETUP_FAIL_MO_ALL-(CALL_SETUP_FAIL_MO_IMS_INCLUS-CALL_SETUP_FAIL_MO_IMS_USBUSY-CALL_SETUP_FAIL_MO_IMS_USEARLY-CALL_SETUP_FAIL_MO_IMS_USNORSP-CALL_SETUP_FAIL_MO_IMS_USWRONG)-(CALL_SETUP_FAIL_MO_CS_INCLUS-CALL_SETUP_FAIL_MO_CS_USBUSY-CALL_SETUP_FAIL_MO_CS_USEARLY-CALL_SETUP_FAIL_MO_CS_USNORSP-CALL_SETUP_FAIL_MO_CS_USWRONG)-CALL_SETUP_FAIL_MO_EPC-(CALL_SETUP_FAIL_MO_RAD_CTXREL+CALL_SETUP_FAIL_MO_RAD_ERABREL+CALL_SETUP_FAIL_MO_RAD_BSRVCC)-CALL_SETUP_FAIL_MO_RAD_UE-(CALL_SETUP_FAIL_MO_USBUSY+CALL_SETUP_FAIL_MO_USEARLY+CALL_SETUP_FAIL_MO_USNORSP+CALL_SETUP_FAIL_MO_USWRONG)

CALL_SETUP_FAIL_MT_ALL-(CALL_SETUP_FAIL_MT_IMS_INCLUS-CALL_SETUP_FAIL_MT_IMS_USBUSY-CALL_SETUP_FAIL_MT_IMS_USEARLY-CALL_SETUP_FAIL_MT_IMS_USNORSP)-(CALL_SETUP_FAIL_MT_CS_INCLUS-CALL_SETUP_FAIL_MT_CS_USBUSY-CALL_SETUP_FAIL_MT_CS_USEARLY-CALL_SETUP_FAIL_MT_CS_USNORSP)-CALL_SETUP_FAIL_MT_EPC-(CALL_SETUP_FAIL_MT_RAD_CTXREL+CALL_SETUP_FAIL_MT_RAD_ERABREL+CALL_SETUP_FAIL_MT_RAD_BSRVCC
)-CALL_SETUP_FAIL_MT_RAD_UE-(CALL_SETUP_FAIL_MT_USBUSY+CALL_SETUP_FAIL_MT_USEARLY+CALL_SETUP_FAIL_MT_USNORSP
)

-----

sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and service_type=1 then 1 else 0 end) as CALL_SETUP_A_SUCC,
sum(case when procedure_type=5 and s1u_flow_status>0 and service_type=1 then 1 else 0 end) as CALL_SETUP_A_ATTEMPT,
(tbb.CALL_SETUP_FAIL_MO_USBUSY+tbb.CALL_SETUP_FAIL_MO_USEARLY+tbb.CALL_SETUP_FAIL_MO_USNORSP+tbb.CALL_SETUP_FAIL_MO_USWRONG) as CALL_SETUP_FAIL_MO_USER,
(tbb.CALL_SETUP_FAIL_MT_USBUSY+tbb.CALL_SETUP_FAIL_MT_USEARLY+tbb.CALL_SETUP_FAIL_MT_USNORSP) as CALL_SETUP_FAIL_MT_USER,

(tbb.CALL_SETUP_FAIL_MO_ALL-(tbb.CALL_SETUP_FAIL_MO_IMS_INCLUS-tbb.CALL_SETUP_FAIL_MO_IMS_USBUSY-tbb.CALL_SETUP_FAIL_MO_IMS_USEARLY-tbb.CALL_SETUP_FAIL_MO_IMS_USNORSP-tbb.CALL_SETUP_FAIL_MO_IMS_USWRONG)-(tbb.CALL_SETUP_FAIL_MO_CS_INCLUS-tbb.CALL_SETUP_FAIL_MO_CS_USBUSY-tbb.CALL_SETUP_FAIL_MO_CS_USEARLY-tbb.CALL_SETUP_FAIL_MO_CS_USNORSP-tbb.CALL_SETUP_FAIL_MO_CS_USWRONG)-tbb.CALL_SETUP_FAIL_MO_EPC-(tbb.CALL_SETUP_FAIL_MO_RAD_CTXREL+tbb.CALL_SETUP_FAIL_MO_RAD_ERABREL+tbb.CALL_SETUP_FAIL_MO_RAD_BSRVCC)-tbb.CALL_SETUP_FAIL_MO_RAD_UE-(tbb.CALL_SETUP_FAIL_MO_USBUSY+tbb.CALL_SETUP_FAIL_MO_USEARLY+tbb.CALL_SETUP_FAIL_MO_USNORSP+tbb.CALL_SETUP_FAIL_MO_USWRONG)) as CALL_SETUP_FAIL_MO_OTHER,


(tbb.CALL_SETUP_FAIL_MT_ALL-(tbb.CALL_SETUP_FAIL_MT_IMS_INCLUS-tbb.CALL_SETUP_FAIL_MT_IMS_USBUSY-tbb.CALL_SETUP_FAIL_MT_IMS_USEARLY-tbb.CALL_SETUP_FAIL_MT_IMS_USNORSP)-(tbb.CALL_SETUP_FAIL_MT_CS_INCLUS-tbb.CALL_SETUP_FAIL_MT_CS_USBUSY-tbb.CALL_SETUP_FAIL_MT_CS_USEARLY-tbb.CALL_SETUP_FAIL_MT_CS_USNORSP)-tbb.CALL_SETUP_FAIL_MT_EPC-(tbb.CALL_SETUP_FAIL_MT_RAD_CTXREL+tbb.CALL_SETUP_FAIL_MT_RAD_ERABREL+tbb.CALL_SETUP_FAIL_MT_RAD_BSRVCC)-tbb.CALL_SETUP_FAIL_MT_RAD_UE-(tbb.CALL_SETUP_FAIL_MT_USBUSY+tbb.CALL_SETUP_FAIL_MT_USEARLY+tbb.CALL_SETUP_FAIL_MT_USNORSP)) as CALL_SETUP_FAIL_MT_OTHER

----



-----

  - CALLSETUP_FAIL_MO_ALL
  - CALLSETUP_FAIL_MO_IMS_INCLUS
  - CALLSETUP_FAIL_MO_IMS_USBUSY
  - CALLSETUP_FAIL_MO_IMS_USEARLY
  - CALLSETUP_FAIL_MO_IMS_USNORSP
  - CALLSETUP_FAIL_MO_IMS_USWRONG
  - CALLSETUP_FAIL_MO_CS_INCLUS
  - CALLSETUP_FAIL_MO_CS_USBUSY
  - CALLSETUP_FAIL_MO_CS_USEARLY
  - CALLSETUP_FAIL_MO_CS_USNORSP
  - CALLSETUP_FAIL_MO_CS_USWRONG
  - CALLSETUP_FAIL_MO_EPC
  - CALLSETUP_FAIL_MO_RAD_CTXREL
  - CALLSETUP_FAIL_MO_RAD_ERABREL
  - CALLSETUP_FAIL_MO_RAD_BSRVCC
  - CALLSETUP_FAIL_MO_RAD_UE
  - CALLSETUP_FAIL_MO_USBUSY
  - CALLSETUP_FAIL_MO_USEARLY
  - CALLSETUP_FAIL_MO_USNORSP
  - CALLSETUP_FAIL_MO_USWRONG
  - CALLSETUP_FAIL_MT_ALL
  - CALLSETUP_FAIL_MT_IMS_INCLUS
  - CALLSETUP_FAIL_MT_IMS_USBUSY
  - CALLSETUP_FAIL_MT_IMS_USEARLY
  - CALLSETUP_FAIL_MT_IMS_USNORSP
  - CALLSETUP_FAIL_MT_CS_INCLUS
  - CALLSETUP_FAIL_MT_CS_USBUSY
  - CALLSETUP_FAIL_MT_CS_USEARLY
  - CALLSETUP_FAIL_MT_CS_USNORSP
  - CALLSETUP_FAIL_MT_EPC
  - CALLSETUP_FAIL_MT_RAD_CTXREL
  - CALLSETUP_FAIL_MT_RAD_ERABREL
  - CALLSETUP_FAIL_MT_RAD_BSRVCC
  - CALLSETUP_FAIL_MT_RAD_UE
  - CALLSETUP_FAIL_MT_USBUSY
  - CALLSETUP_FAIL_MT_USEARLY
  - CALLSETUP_FAIL_MT_USNORSP


CALL_SETUP_FAIL_MO_ALL|CALL_SETUP_FAIL_MO_IMS_INCLUS|CALL_SETUP_FAIL_MO_IMS_USBUSY|CALL_SETUP_FAIL_MO_IMS_USEARLY|CALL_SETUP_FAIL_MO_IMS_USNORSP|CALL_SETUP_FAIL_MO_IMS_USWRONG|CALL_SETUP_FAIL_MO_CS_INCLUS|CALL_SETUP_FAIL_MO_CS_USBUSY|CALL_SETUP_FAIL_MO_CS_USEARLY|CALL_SETUP_FAIL_MO_CS_USNORSP|CALL_SETUP_FAIL_MO_CS_USWRONG|CALL_SETUP_FAIL_MO_EPC|CALL_SETUP_FAIL_MO_RAD_CTXREL|CALL_SETUP_FAIL_MO_RAD_ERABREL|CALL_SETUP_FAIL_MO_RAD_BSRVCC|CALL_SETUP_FAIL_MO_RAD_UE|CALL_SETUP_FAIL_MO_USBUSY|CALL_SETUP_FAIL_MO_USEARLY|CALL_SETUP_FAIL_MO_USNORSP|CALL_SETUP_FAIL_MO_USWRONG|CALL_SETUP_FAIL_MT_ALL|CALL_SETUP_FAIL_MT_IMS_INCLUS|CALL_SETUP_FAIL_MT_IMS_USBUSY|CALL_SETUP_FAIL_MT_IMS_USEARLY|CALL_SETUP_FAIL_MT_IMS_USNORSP|CALL_SETUP_FAIL_MT_CS_INCLUS|CALL_SETUP_FAIL_MT_CS_USBUSY|CALL_SETUP_FAIL_MT_CS_USEARLY|CALL_SETUP_FAIL_MT_CS_USNORSP|CALL_SETUP_FAIL_MT_EPC|CALL_SETUP_FAIL_MT_RAD_CTXREL|CALL_SETUP_FAIL_MT_RAD_ERABREL|CALL_SETUP_FAIL_MT_RAD_BSRVCC|CALL_SETUP_FAIL_MT_RAD_UE|CALL_SETUP_FAIL_MT_USBUSY|CALL_SETUP_FAIL_MT_USEARLY|CALL_SETUP_FAIL_MT_USNORSP|


-----




CALL_SETUP_FAIL_MO_ALL
IF ((Procedure_Type=5 &&Flow_Status IN (2,3,4)&&CALL_SIDE=1) OR (Procedure_Type=5 &&CALL_SIDE=1&&Flow_Status=5&&SV_FLAG=2)) THEN  COUNTER ++

CALL_SETUP_FAIL_MO_IMS_INCLUS
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3,4)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE  in ('SBC','IS_CSCF','AS'))||(Flow_FIRFAIL_Interface IN (1,2)))&&(FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403)or FLOW_FIRFAIL_RESPONSECODE is NULL)) THEN COUNTER++

CALL_SETUP_FAIL_MO_IMS_USBUSY
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_RSPONSECODE=486) THEN COUNTER++

CALL_SETUP_FAIL_MO_IMS_USEARLY
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_TRANSACTION=6 &&(FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL)

CALL_SETUP_FAIL_MO_IMS_USNORSP
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_FINISHREASONCAUSE=18) THEN COUNTER++

CALL_SETUP_FAIL_MO_IMS_USWRONG
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS'))||Flow_FIRFAIL_Interface IN (1,2))&&(FLOW_FIRFAIL_RSPONSECODE=404 OR FLOW_FIRFAIL_FINISHREASONCAUSE=1)) THEN COUNTER++

CALL_SETUP_FAIL_MO_CS_INCLUS
IF(Procedure_Type=5&&CALL_SIDE=1&&(Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&(FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403)or FLOW_FIRFAIL_RESPONSECODE is NULL)) THEN COUNTER++

CALL_SETUP_FAIL_MO_CS_USBUSY
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&FLOW_FIRFAIL_RSPONSECODE=486) THEN COUNTER++

CALL_SETUP_FAIL_MO_CS_USEARLY
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&FLOW_FIRFAIL_TRANSACTION=6 &&(FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL ) THEN COUNTER++

CALL_SETUP_FAIL_MO_CS_USNORSP
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&FLOW_FIRFAIL_FINISHREASONCAUSE=18) THEN COUNTER++

CALL_SETUP_FAIL_MO_CS_USWRONG
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&(FLOW_FIRFAIL_RSPONSECODE=404 OR FLOW_FIRFAIL_FINISHREASONCAUSE=1) THEN COUNTER++

CALL_SETUP_FAIL_MO_EPC
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface IN (9,10,13)&&FLOW_FIRFAIL_NETYPE IN ('MME', 'SPGW', 'PCRF')) THEN COUNTER++

CALL_SETUP_FAIL_MO_RAD_CTXREL
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface=13&&(FLOW_FIRFAIL_NETYPE<> 'MME'  OR FLOW_FIRFAIL_NETYPE IS NULL)&&(S1MME_FF_ProcedureType=20 &&S1MME_FF_Keyword1=1)) THEN COUNTER++

CALL_SETUP_FAIL_MO_RAD_ERABREL
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface=13&&(FLOW_FIRFAIL_NETYPE<> 'MME'  OR FLOW_FIRFAIL_NETYPE IS NULL)&&(S1MME_FF_ProcedureType=21 &&S1MME_FF_Keyword1=1) THEN COUNTER++

CALL_SETUP_FAIL_MO_RAD_BSRVCC
IF(Procedure_Type=5&&Flow_Status=5&&CALL_SIDE=1&&SV_FLAG=2) THEN COUNTER++

CALL_SETUP_FAIL_MO_RAD_UE
IF((Procedure_Type=5&&CALLCALL_SIDE=1&&((Flow_Status IN (2,3,4)&&S1MME_FF_ProcedureStatus=3&&Flow_FIRFAIL_Interface=13&&(FLOW_FIRFAIL_NETYPE<> 'MME'  OR FLOW_FIRFAIL_NETYPE IS NULL) &&((S1MME_FF_ProcedureType<>20 or S1MME_FF_Keyword1<>1) && (S1MME_FF_ProcedureType<>21 or S1MME_FF_Keyword1<>1)))  OR (Procedure_Type=5&&CALLCALL_SIDE=1&&Flow_Status=2&&Flow_FIRFAIL_Interface IN (0,1,2,3,4,5,7,8,11)&&FLOW_FIRFAIL_NETYPE IN  ('SBC','IS_CSCF','AS')&&FLOW_FIRFAIL_RSPONSECODE in (503,400,403))) THEN COUNTER++

CALL_SETUP_FAIL_MO_USBUSY
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_RSPONSECODE=486) THEN COUNTER++

CALL_SETUP_FAIL_MO_USEARLY
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_TRANSACTION=6 &&(FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL)

CALL_SETUP_FAIL_MO_USNORSP
IF(Procedure_Type=5&&CALL_SIDE=1&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_FINISHREASONCAUSE=18) THEN COUNTER++

CALL_SETUP_FAIL_MO_USWRONG
IF(Procedure_Type=5&&Flow_Status IN (2,3)&&CALL_SIDE=1&&FLOW_FIRFAIL_NETYPE IN  ('SBC','IS_CSCF','AS','MGCF','HSS')&&(FLOW_FIRFAIL_RSPONSECODE=404 OR FLOW_FIRFAIL_FINISHREASONCAUSE=1)) THEN COUNTER++

CALL_SETUP_FAIL_MT_ALL
IF ((Procedure_Type=5 &&Flow_Status IN (2,3,4)&&CALL_SIDE=2) OR (Procedure_Type=5 &&CALL_SIDE=1&&Flow_Status=5&&SV_FLAG=2)) THEN  COUNTER ++

CALL_SETUP_FAIL_MT_IMS_INCLUS
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3,4)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE  in ('SBC','IS_CSCF','AS'))||(Flow_FIRFAIL_Interface IN (1,2))&&(FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403)or FLOW_FIRFAIL_RESPONSECODE is NULL))THEN COUNTER++

CALL_SETUP_FAIL_MT_IMS_USBUSY
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_RSPONSECODE=486) THEN COUNTER++

CALL_SETUP_FAIL_MT_IMS_USEARLY
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_TRANSACTION=6 &&(FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL)) THEN COUNTER++

CALL_SETUP_FAIL_MT_IMS_USNORSP
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_FINISHREASONCAUSE=18) THEN COUNTER++

CALL_SETUP_FAIL_MT_CS_INCLUS
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&(FLOW_FIRFAIL_RESPONSECODE NOT IN (503,400,403)or FLOW_FIRFAIL_RESPONSECODE is NULL)) THEN COUNTER++

CALL_SETUP_FAIL_MT_CS_USBUSY
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&FLOW_FIRFAIL_RSPONSECODE=486) THEN COUNTER++

CALL_SETUP_FAIL_MT_CS_USEARLY
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&FLOW_FIRFAIL_TRANSACTION=6 &&(FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL )) THEN COUNTER++

CALL_SETUP_FAIL_MT_CS_USNORSP
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&Flow_FIRFAIL_Interface IN (3,4,5,8,11)&&FLOW_FIRFAIL_NETYPE  in ('MGCF','HSS')&&FLOW_FIRFAIL_FINISHREASONCAUSE=18) THEN COUNTER++

CALL_SETUP_FAIL_MT_EPC
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface IN (9,10,13)&&(FLOW_FIRFAIL_NETYPE in('MME','SPGW','PCRF') THEN COUNTER++

CALL_SETUP_FAIL_MT_RAD_CTXREL
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface=13&&(FLOW_FIRFAIL_NETYPE<> 'MME'  OR FLOW_FIRFAIL_NETYPE IS NULL)&&(S1MME_FF_ProcedureType=20 &&S1MME_FF_Keyword1=1)) THEN COUNTER++

CALL_SETUP_FAIL_MT_RAD_ERABREL
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3,4)&&Flow_FIRFAIL_Interface=13&&(FLOW_FIRFAIL_NETYPE<> 'MME'  OR FLOW_FIRFAIL_NETYPE IS NULL)&&(S1MME_FF_ProcedureType=21 &&S1MME_FF_Keyword1=1)) THEN COUNTER++

CALL_SETUP_FAIL_MT_RAD_BSRVCC
IF(Procedure_Type=5&&Flow_Status=5&&CALL_SIDE=2&&SV_FLAG=2) THEN COUNTER++

CALL_SETUP_FAIL_MT_RAD_UE
IF((Procedure_Type=5&&CALLCALL_SIDE=2&&((Flow_Status IN (2,3,4)&&S1MME_FF_ProcedureStatus=3&&Flow_FIRFAIL_Interface=13&&(FLOW_FIRFAIL_NETYPE<> 'MME'  OR FLOW_FIRFAIL_NETYPE IS NULL) &&((S1MME_FF_ProcedureType<>20 &&S1MME_FF_Keyword1<>1) && (S1MME_FF_ProcedureType<>21 &&S1MME_FF_Keyword1<>1)))  OR (Procedure_Type=5&&CALLCALL_SIDE=1&&Flow_Status=2&&Flow_FIRFAIL_Interface IN (0,1,2,3,4,5,7,8,11)&&FLOW_FIRFAIL_NETYPE IN  ('SBC','IS_CSCF','AS')&&FLOW_FIRFAIL_RSPONSECODE in (503,400,403))) THEN COUNTER++

CALL_SETUP_FAIL_MT_USBUSY
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_RSPONSECODE=486) THEN COUNTER++

CALL_SETUP_FAIL_MT_USEARLY
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_TRANSACTION=6 &&(FLOW_FIRFAIL_FINISHREASONCAUSE=16 OR FLOW_FIRFAIL_FINISHREASONCAUSE=4294967295 OR FLOW_FIRFAIL_FINISHREASONCAUSE IS NULL)) THEN COUNTER++

CALL_SETUP_FAIL_MT_USNORSP
IF(Procedure_Type=5&&CALL_SIDE=2&&Flow_Status IN (2,3)&&((Flow_FIRFAIL_Interface IN (0,3,4,5,7,8,9,11)&&FLOW_FIRFAIL_NETYPE in ('SBC','IS_CSCF','AS','MGCF','HSS'))||Flow_FIRFAIL_Interface IN (1,2))&&FLOW_FIRFAIL_FINISHREASONCAUSE=18) THEN COUNTER++


----

sum(case when procedure_type=1 then 1 else 0 end) @ INITIAL_REGISTER_ATTEMPT,
sum(case when procedure_type=1 and flow_status=1 then 1 else 0 end) @ INITIAL_REGISTER_SUCC,
sum(case when procedure_type=1 and flow_status=1 then FLOW_ENDTIME-b.FLOW_STARTTIME end) @ INITIAL_REGISTER_LATENCY_ALL,
sum(case when procedure_type=9 then 1 else 0 end) @ RE_REGISTER_ATTEMPT,
sum(case when procedure_type=9 and flow_status=1 then 1 else 0 end) @ RE_REGISTER_SUCC,
sum(case when procedure_type=9 and flow_status=1 then FLOW_ENDTIME-b.FLOW_STARTTIME end) @ RE_REGISTER_LATENCY_ALL,
sum(case when procedure_type in(1,9) then 1 else 0 end) @ REGISTER_ATTEMPT,
sum(case when procedure_type in(1,9) and flow_status=1 then 1 else 0 end) @ REGISTER_SUCC,
sum(case when procedure_type in(1,9) and flow_status=1 then datediff_timestamp('MS',FLOW_STARTTIME,FLOW_ENDTIME) end) @ REGISTER_LATENCY_ALL,
sum(case when procedure_type=2 then 1 else 0 end) @ DEREGISTER_ATTEMPT,
sum(case when procedure_type=2 and flow_status=1 then 1 else 0 end) @ DEREGISTER_SUCC,
sum(case when procedure_type=2 and flow_status=1 then datediff_timestamp('MS',FLOW_STARTTIME,FLOW_ENDTIME) end) @ DEREGISTER_LATENCY_ALL,
sum(case when procedure_type=1 and s1u_flow_status>0 and s1u_flow_status <> 4294967295 then 1 else 0 end) @ SBC_REGISTER_SUCC_ATTEMPT,
sum(case when procedure_type=1 and s1u_flow_status=1 then 1 else 0 end) @ SBC_REGISTER_SUCC,
sum(case when procedure_type=1 and mw_flow_status>0 and mw_flow_status <> 4294967295 then 1 else 0 end) @ SCSCF_REGISTER_SUCC_ATTEMPT,
sum(case when procedure_type=1 and mw_flow_status=1 then 1 else 0 end) @ SCSCF_REGISTER_SUCC,
sum(case when procedure_type=1 and length(cx_mar_xdrid)>0 then 1 else 0 end) @ MAR_ATTEMPT,
sum(case when procedure_type=1 and length(cx_mar_xdrid)>0 and cx_mar_transaction_status=1 then 1 else 0 end) @ MAR_SUCC,
sum(case when procedure_type=1 and flow_status in (2,4) then 1 else 0 end) @ INIT_REGISTER_FAIL_ALL,
sum(case when procedure_type=1 and flow_status IN (2,4) and flow_firfail_interface IN (0,1,8) and flow_firfail_netype IN ('SBC','IS_CSCF') and (flow_firfail_responsecode NOT IN (400,401,408,500,403,404,421,503) OR flow_firfail_responsecode IS NULL) then 1 else 0 end) @ INIT_REGFAIL_IMS,
sum(case when procedure_type=1  and flow_status IN (2,4) and flow_firfail_interface=8  and flow_firfail_netype= 'HSS' then 1 else 0 end) @ INIT_REGFAIL_CS,
sum(case when procedure_type=1  and flow_status IN (2,4) and flow_firfail_interface IN (9,10,13) and flow_firfail_netype IN( 'MME', 'SPGW' ,'PCRF') then 1 else 0 end) @ INIT_REGFAIL_EPC,
sum(case when procedure_type=1  and flow_status IN (2,4) and flow_firfail_interface=13 and flow_firfail_netype<> 'MME'  and ((s1mme_ff_proceduretype=20  and s1mme_ff_keyword1=1) or (s1mme_ff_proceduretype=21  and s1mme_ff_keyword1=1)) then 1 else 0 end) @ INIT_REGFAIL_RAD,
sum(case when procedure_type=1  and flow_status IN (2,4) and flow_firfail_interface=13 and flow_firfail_netype<> 'MME'  and (s1mme_ff_proceduretype=20  and s1mme_ff_keyword1=1) then 1 else 0 end) @ INIT_REGFAIL_RAD_CXTREL,
sum(case when procedure_type=1  and flow_status IN (2,4) and flow_firfail_interface=13 and flow_firfail_netype<> 'MME'    and (s1mme_ff_proceduretype=21  and s1mme_ff_keyword1=1) then 1 else 0 end) @ INIT_REGFAIL_RAD_ERABREL,
sum(case when (procedure_type=1  and (flow_status=2 and flow_firfail_interface in (0,1,8) and flow_firfail_netype in ('sbc','is_cscf') or flow_firfail_netype is  null) and flow_firfail_responsecode  in (400,401,408,500,403,404,421,503)) or (procedure_type=1 and flow_status=4 and flow_firfail_interface=13 and flow_firfail_netype<> 'mme'  and ((s1mme_ff_proceduretype<>20  or s1mme_ff_keyword1<>1)  and  (s1mme_ff_proceduretype<>21 or  s1mme_ff_keyword1<>1))) then 1 else 0 end) @ INIT_REGFAIL_RAD_UE,
sum(case when procedure_type=1  and flow_status=4 and flow_firfail_interface IN(0,1,8) and flow_firfail_netype IN('SBC','IS_CSCF') then 1 else 0 end) @ INIT_REGFAIL_IMS_EXPIRY,
sum(case when procedure_type=1  and flow_status=4 and flow_firfail_interface=8 and flow_firfail_netype='HSS' then 1 else 0 end) @ INIT_REGFAIL_CS_EXPIRY,
sum(case when procedure_type=1  and flow_status=4 and flow_firfail_interface IN(9,10,13) and flow_firfail_netype IN('MME', 'SPGW' ,'PCRF') then 1 else 0 end) @ INIT_REGFAIL_EPC_EXPIRY,
sum(case when procedure_type=1  and flow_status=4 and flow_firfail_interface=13 and flow_firfail_netype<> 'MME'  and flow_firfail_responsecode<>401 then 1 else 0 end) @ INIT_REGFAIL_RAD_EXPIRY,
sum(case when procedure_type=5 then 1 else 0 end) @ CALL_SETUP_ATTEMPT,
sum(case when procedure_type=5 and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_ATTEMPT,
sum(case when procedure_type=5 and service_type=2 then 1 else 0 end) @ CALL_SETUP_V_ATTEMPT,
sum(case when procedure_type=5 and call_side=1 then 1 else 0 end) @ CALL_SETUP_MO_ATTEMPT,
sum(case when procedure_type=5 and call_side=1 and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_MO_ATTEMPT,
sum(case when procedure_type=5 and call_side=1 and service_type=2 then 1 else 0 end) @ CALL_SETUP_V_MO_ATTEMPT,
sum(case when procedure_type=5 and call_side=2 then 1 else 0 end) @ CALL_SETUP_MT_ATTEMPT,
sum(case when procedure_type=5 and call_side=2 and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_MT_ATTEMPT,
sum(case when procedure_type=5 and call_side=2 and service_type=2 then 1 else 0 end) @ CALL_SETUP_V_MT_ATTEMPT,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) then 1 else 0 end) @ CALL_SETUP_SUCC,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_SUCC,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and service_type=2 then 1 else 0 end) @ CALL_SETUP_V_SUCC,
sum(case when procedure_type=5 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_LATENCY_ALL,
sum(case when procedure_type=5 and service_type=1 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_A_LATENCY_ALL,
sum(case when procedure_type=5 and service_type=2 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_V_LATENCY_ALL,
sum(case when procedure_type=5 and (s1u_alerting_time>0 OR s1u_answer_time>0) and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_SUCC_SBC,
sum(case when procedure_type=5 and (mw_alerting_time>0 OR  mw_answer_time>0) and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_SUCC_SCSCF,
sum(case when procedure_type=5 and (isc_alerting_time>0 OR isc_answer_time>0) and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_SUCC_AS,
sum(case when procedure_type=5 and (mg_alerting_time>0 OR  mg_answer_time>0) and service_type=1 then 1 else 0 end) @ CALL_SETUP_A_SUCC_MGCF,
sum(case when procedure_type=5 and call_side=1 and (s1u_alerting_time>0 or ((s1u_alerting_time=0 OR s1u_alerting_time IS NULL) and s1u_answer_time>0)) then (case when s1u_alerting_time>0 then s1u_alerting_time ELSE s1u_answer_time end) end) @ CALL_SETUP_A_MO_SUC_SBC_LAT_ALL,
sum(case when procedure_type=5 and call_side=1 and (mw_alerting_time>0 or ((mw_alerting_time=0 OR mw_alerting_time IS NULL) and mw_answer_time>0)) then (case when mw_alerting_time>0 then mw_alerting_time ELSE mw_answer_time end) end) @ CALL_SETUP_A_MO_SUC_SCS_LAT_ALL,
sum(case when procedure_type=5 and call_side=1 and (isc_alerting_time>0 or ((isc_alerting_time=0 OR isc_alerting_time IS NULL) and isc_answer_time>0)) then (case when isc_alerting_time>0 then isc_alerting_time ELSE isc_answer_time end) end) @ CALL_SETUP_A_MO_SUC_AS_LAT_ALL,
sum(case when procedure_type=5 and call_side=1 and (mg_alerting_time>0 or ((mg_alerting_time=0 OR mg_alerting_time IS NULL) and mg_answer_time>0)) then (case when mg_alerting_time>0 then mg_alerting_time ELSE mg_answer_time end) end) @ CALL_SETUP_A_MO_SUC_MG_LAT_ALL,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and call_side=1 then 1 else 0 end) @ CALL_SETUP_MO_SUCC,
sum(case when procedure_type=5 and call_side=1 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_MO_LATENCY_ALL,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and service_type=1 and call_side=1 then 1 else 0 end) @ CALL_SETUP_A_MO_SUCC,
sum(case when procedure_type=5 and service_type=1 and call_side=1 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_A_MO_LATENCY_ALL,
sum(case when procedure_type=5 and alerting_time>0 and service_type=2 and call_side=1 then 1 else 0 end) @ CALL_SETUP_V_MO_SUCC,
sum(case when procedure_type=5 and service_type=2 and call_side=1 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_V_MO_LATENCY_ALL,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and call_side=2 then 1 else 0 end) @ CALL_SETUP_MT_SUCC,
sum(case when procedure_type=5 and call_side=2 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_MT_LATENCY_ALL,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and service_type=1 and call_side=2 then 1 else 0 end) @ CALL_SETUP_A_MT_SUCC,
sum(case when procedure_type=5 and service_type=1 and call_side=2 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_A_MT_LATENCY_ALL,
sum(case when procedure_type=5 and (alerting_time>0 OR answer_time>0) and service_type=2 and call_side=2 then 1 else 0 end) @ CALL_SETUP_V_MT_SUCC,
sum(case when procedure_type=5 and service_type=2 and call_side=2 and (alerting_time>0 or ((alerting_time=0 OR alerting_time IS NULL) and answer_time>0)) then (case when alerting_time>0 then alerting_time ELSE answer_time end) end) @ CALL_SETUP_V_MT_LATENCY_ALL,
sum(case when procedure_type=5 and answer_time>0 then 1 else 0 end) @ CALL_ANS_SUCC,
sum(case when procedure_type=5 and answer_time>0 and service_type=1 then 1 else 0 end) @ CALL_ANS_A_SUCC,
sum(case when procedure_type=5 and answer_time>0 and service_type=2 then 1 else 0 end) @ CALL_ANS_V_SUCC,
sum(case when procedure_type=5 and answer_time>0 and call_side=1 then 1 else 0 end) @ CALL_ANS_MO_SUCC,
sum(case when procedure_type=5 and answer_time>0 and call_side=1 and service_type=1 then 1 else 0 end) @ CALL_ANS_A_MO_SUCC,
sum(case when procedure_type=5 and answer_time>0 and call_side=1 and service_type=2 then 1 end) @ CALL_ANS_V_MO_SUCC,
sum(case when procedure_type=5  and  answer_time>0 and call_side=2 then 1 else 0 end) @ CALL_ANS_MT_SUCC,
sum(case when procedure_type=5 and answer_time>0 and call_side=2 and service_type=1 then 1 else 0 end) @ CALL_ANS_A_MT_SUCC,
sum(case when procedure_type=5 and answer_time>0 and call_side=2 and service_type=2 then 1 else 0 end) @ CALL_ANS_V_MT_SUCC,
sum(case when procedure_type=5 and call_side=1 and answer_time>0 then answer_time end) @ CALL_ANS_MO_LATENCY_ALL,
sum(case when procedure_type=5  and call_side=1 and service_type=1 and answer_time>0 then answer_time end) @ CALL_ANS_A_MO_LATENCY_ALL,
sum(case when procedure_type=5  and call_side=1 and service_type=2 and answer_time>0 then answer_time end) @ CALL_ANS_V_MO_LATENCY_ALL,
sum(case when procedure_type=5  and call_side=2 and answer_time>0 then answer_time end) @ CALL_ANS_MT_LATENCY_ALL,
sum(case when procedure_type=5  and call_side=2 and service_type=1 and answer_time>0 then answer_time end) @ CALL_ANS_A_MT_LATENCY_ALL,
sum(case when procedure_type=5  and call_side=2 and service_type=2 and answer_time>0 then answer_time end) @ CALL_ANS_V_MT_LATENCY_ALL,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0  then call_duration end) @ call_duration,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and service_type=1 then call_duration end) @ call_duration_A,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and service_type=2 then call_duration end) @ call_duration_V,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and call_side=1  then call_duration end) @ call_duration_MO,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and call_side=1 and service_type=1 then call_duration end) @ call_duration_A_MO,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and call_side=1 and service_type=2 then call_duration end) @ call_duration_V_MO,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and call_side=2  then call_duration end) @ call_duration_MT,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and call_side=2 and service_type=1 then call_duration end) @ call_duration_A_MT,
sum(case when procedure_type=5  and answer_time>0 and call_duration>0 and call_side=2 and service_type=2 then call_duration end) @ call_duration_V_MT,
sum(case when (procedure_type=5  and flow_status IN (2,3,4) and call_side=1) OR (procedure_type=5  and call_side=1 and flow_status=5 and sv_flag=2) then 1 else 0 end) @ CALL_SETUP_FAIL_MO_ALL,
sum(case when (procedure_type=5  and flow_status IN (2,3,4) and call_side=2) OR (procedure_type=5  and call_side=1 and flow_status=5 and sv_flag=2) then 1 else 0 end) @ CALL_SETUP_FAIL_MT_ALL,
sum(case when procedure_type=5 and call_side=1 and flow_status in (2,3,4) and ((flow_firfail_interface in (0,3,4,5,7,8,9,11) and flow_firfail_netype  in ('sbc','is_cscf','@')) or (flow_firfail_interface in (1,2))) and (flow_firfail_responsecode not in (503,400,403) or flow_firfail_responsecode is null) then 1 else 0 end) @ CALL_SETUP_FAIL_MO_IMS_INCLUS,
sum(case when procedure_type=5 and call_side=1 and (flow_status IN (2,3,4) and flow_firfail_interface IN (3,4,5,8,11) and flow_firfail_netype  in ('MGCF','HSS') and (flow_firfail_responsecode NOT IN (503,400,403) or flow_firfail_responsecode is NULL)) then 1 else 0 end) @ CALL_SETUP_FAIL_MO_CS_INCLUS,
sum(case when procedure_type=5 and call_side=1 and flow_status IN (2,3,4) and flow_firfail_interface IN (9,10,13) and flow_firfail_netype IN ('MME', 'SPGW', 'PCRF') then 1 else 0 end) @ CALL_SETUP_FAIL_MO_EPC,
sum(case when procedure_type=5 and call_side=1 and flow_status IN (2,3,4) and flow_firfail_interface=13 and flow_firfail_netype<>'MME' and (s1mme_ff_proceduretype=20  and s1mme_ff_keyword1=1) then 1 else 0 end) @ CALL_SETUP_FAIL_MO_RAD_CTXREL,
sum(case when procedure_type=5 and call_side=1 and flow_status IN (2,3,4) and flow_firfail_interface=13 and flow_firfail_netype<>'MME' and (s1mme_ff_proceduretype=21  and s1mme_ff_keyword1=1) then 1 else 0 end) @ CALL_SETUP_FAIL_MO_RAD_ERABREL,
sum(case when procedure_type=5 and flow_status=5 and call_side=1 and sv_flag=2 then 1 else 0 end) @ CALL_SETUP_FAIL_MO_RAD_BSRVCC,
sum(case when procedure_type=5 and call_side=1 and flow_status IN (2,3) and ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) and flow_firfail_netype in ('SBC','IS_CSCF','@','MGCF','HSS')) or flow_firfail_interface IN (1,2)) and flow_firfail_responsecode=486 then 1 else 0 end) @ CALL_SETUP_FAIL_MO_USBUSY,
sum(case when procedure_type=5 and call_side=1 and flow_status IN (2,3) and ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) and flow_firfail_netype in ('SBC','IS_CSCF','@')) or flow_firfail_interface IN (1,2)) and flow_firfail_responsecode=486 then 1 else 0 end) @ CALL_SETUP_FAIL_MO_IMS_USBUSY,
sum(case when procedure_type=5 and call_side=1 and flow_status in (2,3) and flow_firfail_interface in (3,4,5,8,11) and flow_firfail_netype  in ('mgcf','hss') and flow_firfail_responsecode=486 then 1 else 0 end) @ CALL_SETUP_FAIL_MO_CS_USBUSY,
sum(case when procedure_type=5 and call_side=1 and flow_status IN (2,3) and ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) and flow_firfail_netype in ('SBC','IS_CSCF','@','MGCF','HSS')) or flow_firfail_interface IN (1,2)) and flow_firfail_transaction=6  and (flow_firfail_finishreasoncause=16 OR flow_firfail_finishreasoncause=4294967295 OR flow_firfail_finishreasoncause IS NULL) then 1 else 0 end) @ CALL_SETUP_FAIL_MO_USEARLY,
sum(case when procedure_type=5 and call_side=1 and flow_status in (2,3) and ((flow_firfail_interface in (0,3,4,5,7,8,9,11) and flow_firfail_netype in ('sbc','is_cscf','@')) or flow_firfail_interface in (1,2)) and flow_firfail_transaction=6  and (flow_firfail_finishreasoncause=16 or flow_firfail_finishreasoncause=4294967295 or flow_firfail_finishreasoncause is null) then 1 else 0 end) @ CALL_SETUP_FAIL_MO_IMS_USEARLY,
sum(case when procedure_type=5 and call_side=1 and flow_status IN (2,3) and flow_firfail_interface IN (3,4,5,8,11) and flow_firfail_netype  in ('MGCF','HSS') and flow_firfail_transaction=6  and (flow_firfail_finishreasoncause=16 OR flow_firfail_finishreasoncause=4294967295 OR flow_firfail_finishreasoncause IS NULL)  then 1 else 0 end) @ CALL_SETUP_FAIL_MO_CS_USEARLY,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@','MGCF','HSS')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_finishreasoncause=18 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_USNORSP,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_finishreasoncause=18 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_IMS_USNORSP,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_status IN (2,3) AND flow_firfail_interface IN (3,4,5,8,11) AND flow_firfail_netype IN ('MGCF','HSS') AND flow_firfail_finishreasoncause=18 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_CS_USNORSP,
sum(CASE WHEN procedure_type=5 AND flow_status IN (2,3) AND call_side=1 AND flow_firfail_netype IN ('SBC','IS_CSCF','@','MGCF','HSS') AND (flow_firfail_responsecode=404 OR flow_firfail_finishreasoncause=1) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_USWRONG,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@')) OR flow_firfail_interface IN (1,2)) AND (flow_firfail_responsecode=404 OR flow_firfail_finishreasoncause=1) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_IMS_USWRONG,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_status IN (2,3) AND flow_firfail_interface IN (3,4,5,8,11) AND flow_firfail_netype IN ('MGCF','HSS') AND (flow_firfail_responsecode=404 OR flow_firfail_finishreasoncause=1) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_CS_USWRONG,
sum(CASE WHEN (procedure_type=5 AND call_side=1 AND ((flow_status IN (2,3,4) AND s1mme_ff_procedurestatus=3 AND flow_firfail_interface=13 AND flow_firfail_netype<> 'MME'AND ((s1mme_ff_proceduretype<>20 OR s1mme_ff_keyword1<>1) AND (s1mme_ff_proceduretype<>21 OR s1mme_ff_keyword1<>1))) OR (procedure_type=5 AND call_side=1 AND flow_status=2 AND flow_firfail_interface IN (0,1,2,3,4,5,7,8,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@') AND flow_firfail_responsecode IN (503,400,403)))) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_RAD_UE,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND ((flow_status IN (2, 3, 4) AND s1mme_ff_procedurestatus=3 AND flow_firfail_interface=13 AND flow_firfail_netype<> 'MME'AND ((s1mme_ff_proceduretype<>20 OR s1mme_ff_keyword1<>1) AND (s1mme_ff_proceduretype<>21 OR s1mme_ff_keyword1<>1)))) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_RAD_UE_NANS,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_status=2 AND flow_firfail_interface IN (0,1,2,3,4,5,7,8,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@') AND flow_firfail_responsecode IN (503,400,403) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_RAD_UE_AB,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3,4) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@')) OR (flow_firfail_interface IN (1,2)) AND (flow_firfail_responsecode NOT IN (503,400,403) OR flow_firfail_responsecode IS NULL)) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_IMS_INCLUS,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3,4) AND flow_firfail_interface IN (3,4,5,8,11) AND flow_firfail_netype IN ('MGCF','HSS') AND (flow_firfail_responsecode NOT IN (503,400,403) OR flow_firfail_responsecode IS NULL) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_CS_INCLUS,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3,4) AND flow_firfail_interface IN (9,10,13) AND (flow_firfail_netype IN('MME','SPGW','PCRF')) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_EPC,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3,4) AND flow_firfail_interface=13 AND flow_firfail_netype<>'MME'AND (s1mme_ff_proceduretype=20 AND s1mme_ff_keyword1=1) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_RAD_CTXREL,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3,4) AND flow_firfail_interface=13 AND flow_firfail_netype<>'MME'AND (s1mme_ff_proceduretype=21 AND s1mme_ff_keyword1=1) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_RAD_ERABREL,
sum(CASE WHEN procedure_type=5 AND flow_status=5 AND call_side=2 AND sv_flag=2 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_RAD_BSRVCC,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@','MGCF','HSS')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_responsecode=486 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_USBUSY,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_responsecode=486 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_IMS_USBUSY,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND flow_firfail_interface IN (3,4,5,8,11) AND flow_firfail_netype IN ('MGCF','HSS') AND flow_firfail_responsecode=486 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_CS_USBUSY,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@','MGCF','HSS')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_transaction=6 AND (flow_firfail_finishreasoncause=16 OR flow_firfail_finishreasoncause=4294967295 OR flow_firfail_finishreasoncause IS NULL) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_USEARLY,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_transaction=6 AND (flow_firfail_finishreasoncause=16 OR flow_firfail_finishreasoncause=4294967295 OR flow_firfail_finishreasoncause IS NULL) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_IMS_USEARLY,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND flow_firfail_interface IN (3,4,5,8,11) AND flow_firfail_netype IN ('MGCF','HSS') AND flow_firfail_transaction=6 AND (flow_firfail_finishreasoncause=16 OR flow_firfail_finishreasoncause=4294967295 OR flow_firfail_finishreasoncause IS NULL) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_CS_USEARLY,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@','MGCF','HSS')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_finishreasoncause=18 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_USNORSP,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND ((flow_firfail_interface IN (0,3,4,5,7,8,9,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@')) OR flow_firfail_interface IN (1,2)) AND flow_firfail_finishreasoncause=18 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_IMS_USNORSP,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status IN (2,3) AND flow_firfail_interface IN (3,4,5,8,11) AND flow_firfail_netype IN ('MGCF','HSS') AND flow_firfail_finishreasoncause=18 THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_CS_USNORSP,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND ((flow_status IN (2,3,4) AND s1mme_ff_procedurestatus=3 AND flow_firfail_interface=13 AND flow_firfail_netype<> 'MME'AND ((s1mme_ff_proceduretype<>20 AND s1mme_ff_keyword1<>1) AND (s1mme_ff_proceduretype<>21 AND s1mme_ff_keyword1<>1))) OR (procedure_type=5 AND call_side=1 AND flow_status=2 AND flow_firfail_interface IN (0, 1, 2, 3, 4, 5, 7, 8, 11) AND flow_firfail_netype IN ('SBC', 'IS_CSCF', '@') AND flow_firfail_responsecode IN (503, 400, 403))) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_RAD_UE,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND ((flow_status IN (2,3,4) AND s1mme_ff_procedurestatus=3 AND flow_firfail_interface=13 AND flow_firfail_netype<> 'MME'AND ((s1mme_ff_proceduretype<>20 AND s1mme_ff_keyword1<>1) AND (s1mme_ff_proceduretype<>21 AND s1mme_ff_keyword1<>1)))) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_RAD_UE_NANS,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status=2 AND flow_firfail_interface IN (0,1,2,3,4,5,7,8,11) AND flow_firfail_netype IN ('SBC','IS_CSCF','@') AND flow_firfail_responsecode IN (503,400,403) THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_RAD_UE_AB,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_firfail_interface IN (0,1,2,3,4,5,7,8,11) AND flow_status=4 AND flow_firfail_netype IN ('SBC','IS_CSCF','@') THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_TEXPIRY_IMS,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_firfail_interface IN (0,1,2,3,4,5,7,8,11) AND flow_status=4 AND flow_firfail_netype IN ('SBC','IS_CSCF','@') THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_TEXPIRY_IMS,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_firfail_interface IN (8,11) AND flow_status=4 AND flow_firfail_netype IN ('MGCF','HSS') THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_TEXPIRY_CS,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_firfail_interface IN (8,11) AND flow_status=4 AND flow_firfail_netype IN ('MGCF','HSS') THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_TEXPIRY_CS,
sum(case when procedure_type=5 and call_side=1 and flow_firfail_interface in (9,10,13) and flow_status=4 and flow_firfail_netype in  ('mme'  , 'spgw' , 'pcrf') then 1 else 0 end) @ CALL_SETUP_FAIL_MO_TEXPIRY_EPC,
sum(case when procedure_type=5 and call_side=2 and flow_firfail_interface in (9,10,13) and flow_status=4 and flow_firfail_netype in  ('mme'  , 'spgw' , 'pcrf') then 1 else 0 end) @ CALL_SETUP_FAIL_MT_TEXPIRY_EPC,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND flow_status=4 AND flow_firfail_interface=13 AND flow_firfail_netype<>'MME' THEN 1 else 0 END) @ CALL_SETUP_FAIL_MO_TEXPIRY_RAD,
sum(CASE WHEN procedure_type=5 AND call_side=2 AND flow_status=4 AND flow_firfail_interface=13 AND flow_firfail_netype<>'MME' THEN 1 else 0 END) @ CALL_SETUP_FAIL_MT_TEXPIRY_RAD,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND called_number IN (10086,8610086) THEN 1 else 0 END) @ CALL_SETUP_ATTEMP_VT10086,
sum(CASE WHEN procedure_type=5 AND call_side=1 AND (alerting_time>0 OR answer_time>0) AND called_number IN (10086,8610086) THEN 1 else 0 END) @ CALL_SETUP_SUC_VT10086,
sum(CASE WHEN procedure_type=5 AND (alerting_time>0 OR answer_time>0) AND call_side=1 AND called_number IN (10086,8610086) THEN (CASE WHEN alerting_time>0 THEN alerting_time ELSE answer_time END) END) @ CALL_SETUP_VT10086_LATENCY_ALL,
sum(case when procedure_type=5 and call_side=1 and (alerting_time>0 or answer_time>0) and source_access_type in (1,2)  and dest_access_type in (1,2) then 1 else 0 end) @ CALL_SETUP_SUC_VTV,
sum(case when procedure_type=5 and  (alerting_time>0 or answer_time>0) and call_side=1 and called_number in (10086,8610086)  then (case when alerting_time>0 then alerting_time else answer_time end) else 0 end) @ CALL_SETUP_VTV_LATENCY_ALL,
sum(case when procedure_type=5 and s1u_flow_status>0 and service_type=1 then 1 else 0 end) @ CALLSETUP_A_ATTEMPT_SBC,
sum(case when procedure_type=5 and mw_flow_status>0 and service_type=1 then 1 else 0 end) @ CALLSETUP_A_ATTEMPT_SCSCF,
sum(case when procedure_type=5 and isc_flow_status>0 and service_type=1 then 1 else 0 end) @ CALLSETUP_A_ATTEMPT_AS,
sum(case when procedure_type=5 and mg_flow_status>0 and service_type=1 then 1 else 0 end) @ CALLSETUP_A_ATTEMPT_MGCF,


----