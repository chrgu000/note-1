USE tmp;
DROP TABLE IF EXISTS `mme`;
CREATE EXTERNAL TABLE `mme`(
  `length` string,
  `local_province` string,
  `local_city` string,
  `owner_province` string,
  `owner_city` string,
  `roaming_type` string,
  `interface_` string,
  `xdr_id` string,
  `rat` string,
  `imsi` string,
  `imei` string,
  `msisdn` string,
  `procedure_type` string,
  `procedure_start_time` string,
  `procedure_end_time` string,
  `startlocation-longitude` string,
  `startlocation-latitude` string,
  `location_source` string,
  `msgflag` string,
  `procedure_status` string,
  `request_cause_group` string,
  `request_cause_specific` string,
  `failure_cause_group` string,
  `failure_cause_specific` string,
  `keyword1` string,
  `keyword2` string,
  `keyword3` string,
  `keyword4` string,
  `mme_ue_s1ap_id` string,
  `old_mme_group_id` string,
  `old_mme_code` string,
  `old_m_tmsi` string,
  `old_guti_type` string,
  `mme_group_id` string,
  `mme_code` string,
  `m_tmsi` string,
  `tmsi` string,
  `user_ipv4` string,
  `user_ipv6` string,
  `mme_ip_add` string,
  `enb_ip_add` string,
  `mme_port` string,
  `enb_port` string,
  `tac` string,
  `cell_id` string,
  `other_tac` string,
  `other_eci` string,
  `apn` string,
  `eps_bearer_number` string,
  `bearer_id_1` string,
  `bearer_type_1` string,
  `bearer_qci_1` string,
  `bearer_status_1` string,
  `bearerrequestcausegroup_1` string,
  `bearerrequestcausespecific_1` string,
  `bearerfailurecausegroup_1` string,
  `bearerfailurecausespecific_1` string,
  `bearer_enb_gtp_teid_1` string,
  `bearer_sgw_gtp_teid_1` string,
  `bearer_id_2` string,
  `bearer_type_2` string,
  `bearer_qci_2` string,
  `bearer_status_2` string,
  `bearerrequestcausegroup_2` string,
  `bearerrequestcausespecific_2` string,
  `bearerfailurecausegroup_2` string,
  `bearerfailurecausespecific_2` string,
  `bearer_enb_gtp_teid_2` string,
  `bearer_sgw_gtp_teid_2` string,
  `bearer_id_3` string,
  `bearer_type_3` string,
  `bearer_qci_3` string,
  `bearer_status_3` string,
  `bearerrequestcausegroup_3` string,
  `bearerrequestcausespecific_3` string,
  `bearerfailurecausegroup_3` string,
  `bearerfailurecausespecific_3` string,
  `bearer_enb_gtp_teid_3` string,
  `bearer_sgw_gtp_teid_3` string,
  `bearer_id_4` string,
  `bearer_type_4` string,
  `bearer_qci_4` string,
  `bearer_status_4` string,
  `bearerrequestcausegroup_4` string,
  `bearerrequestcausespecific_4` string,
  `bearerfailurecausegroup_4` string,
  `bearerfailurecausespecific_4` string,
  `bearer_enb_gtp_teid_4` string,
  `bearer_sgw_gtp_teid_4` string,
  `bearer_id_5` string,
  `bearer_type_5` string,
  `bearer_qci_5` string,
  `bearer_status_5` string,
  `bearerrequestcausegroup_5` string,
  `bearerrequestcausespecific_5` string,
  `bearerfailurecausegroup_5` string,
  `bearerfailurecausespecific_5` string,
  `bearer_enb_gtp_teid_5` string,
  `bearer_sgw_gtp_teid_5` string,
  `bearer_id_6` string,
  `bearer_type_6` string,
  `bearer_qci_6` string,
  `bearer_status_6` string,
  `bearerrequestcausegroup_6` string,
  `bearerrequestcausespecific_6` string,
  `bearerfailurecausegroup_6` string,
  `bearerfailurecausespecific_6` string,
  `bearer_enb_gtp_teid_6` string,
  `bearer_sgw_gtp_teid_6` string,
  `bearer_id_7` string,
  `bearer_type_7` string,
  `bearer_qci_7` string,
  `bearer_status_7` string,
  `bearerrequestcausegroup_7` string,
  `bearerrequestcausespecific_7` string,
  `bearerfailurecausegroup_7` string,
  `bearerfailurecausespecific_7` string,
  `bearer_enb_gtp_teid_7` string,
  `bearer_sgw_gtp_teid_7` string,
  `bearer_id_8` string,
  `bearer_type_8` string,
  `bearer_qci_8` string,
  `bearer_status_8` string,
  `bearerrequestcausegroup_8` string,
  `bearerrequestcausespecific_8` string,
  `bearerfailurecausegroup_8` string,
  `bearerfailurecausespecific_8` string,
  `bearer_enb_gtp_teid_8` string,
  `bearer_sgw_gtp_teid_8` string,
  `bearer_id_9` string,
  `bearer_type_9` string,
  `bearer_qci_9` string,
  `bearer_status_9` string,
  `bearerrequestcausegroup_9` string,
  `bearerrequestcausespecific_9` string,
  `bearerfailurecausegroup_9` string,
  `bearerfailurecausespecific_9` string,
  `bearer_enb_gtp_teid_9` string,
  `bearer_sgw_gtp_teid_9` string,
  `bearer_id_10` string,
  `bearer_type_10` string,
  `bearer_qci_10` string,
  `bearer_status_10` string,
  `bearerrequestcausegroup_10` string,
  `bearerrequestcausespecific_10` string,
  `bearerfailurecausegroup_10` string,
  `bearerfailurecausespecific_10` string,
  `bearer_enb_gtp_teid_10` string,
  `bearer_sgw_gtp_teid_10` string,
  `bearer_id_11` string,
  `bearer_type_11` string,
  `bearer_qci_11` string,
  `bearer_status_11` string,
  `bearerrequestcausegroup_11` string,
  `bearerrequestcausespecific_11` string,
  `bearerfailurecausegroup_11` string,
  `bearerfailurecausespecific_11` string,
  `bearer_enb_gtp_teid_11` string,
  `bearer_sgw_gtp_teid_11` string,
  `bearer_id_12` string,
  `bearer_type_12` string,
  `bearer_qci_12` string,
  `bearer_status_12` string,
  `bearerrequestcausegroup_12` string,
  `bearerrequestcausespecific_12` string,
  `bearerfailurecausegroup_12` string,
  `bearerfailurecausespecific_12` string,
  `bearer_enb_gtp_teid_12` string,
  `bearer_sgw_gtp_teid_12` string,
  `bearer_id_13` string,
  `bearer_type_13` string,
  `bearer_qci_13` string,
  `bearer_status_13` string,
  `bearerrequestcausegroup_13` string,
  `bearerrequestcausespecific_13` string,
  `bearerfailurecausegroup_13` string,
  `bearerfailurecausespecific_13` string,
  `bearer_enb_gtp_teid_13` string,
  `bearer_sgw_gtp_teid_13` string,
  `bearer_id_14` string,
  `bearer_type_14` string,
  `bearer_qci_14` string,
  `bearer_status_14` string,
  `bearerrequestcausegroup_14` string,
  `bearerrequestcausespecific_14` string,
  `bearerfailurecausegroup_14` string,
  `bearerfailurecausespecific_14` string,
  `bearer_enb_gtp_teid_14` string,
  `bearer_sgw_gtp_teid_14` string,
  `bearer_id_15` string,
  `bearer_type_15` string,
  `bearer_qci_15` string,
  `bearer_status_15` string,
  `bearerrequestcausegroup_15` string,
  `bearerrequestcausespecific_15` string,
  `bearerfailurecausegroup_15` string,
  `bearerfailurecausespecific_15` string,
  `bearer_enb_gtp_teid_15` string,
  `bearer_sgw_gtp_teid_15` string,
  `bearer_id_16` string,
  `bearer_type_16` string,
  `bearer_qci_16` string,
  `bearer_status_16` string,
  `bearerrequestcausegroup_16` string,
  `bearerrequestcausespecific_16` string,
  `bearerfailurecausegroup_16` string,
  `bearerfailurecausespecific_16` string,
  `bearer_enb_gtp_teid_16` string,
  `bearer_sgw_gtp_teid_16` string
  )
PARTITIONED BY (
  `phour` string)
ROW FORMAT SERDE
  'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
  'separatorChar'='|')
STORED AS INPUTFORMAT
  'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
  'hdfs://bjmcc-hdp-cluster-node-06.do:8020/data/volte/mme'