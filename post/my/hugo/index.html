<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>hugo</title>
<meta name="description" content=" John Doe&#39;s Personal blog about everything">
<meta name="generator" content="Hugo 0.17" />
<meta property="og:title" content="hugo" />
<meta property="og:description" content="hugo1. 环境2. hugo2.1. 设置发布目录2.2. 部署2.2.1. 带项目名2.2.2. 不带项目名3. 生成 lunr 索引4. 参考1. 环境软件下载地址Ruby
Ruby 2.3.3 (x64)
Asciidoctor
gem install asciidoctor asciidoctor-diagram &lt;1&gt;
graphviz
graphviz version 2.38.0
1asciidoctor-diagram plantuml图设置淘宝gem源" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/my/hugo/" />


<meta property="og:updated_time" content="2017-03-08T00:00:00&#43;00:00"/>











<link rel="stylesheet" href="/css/google-font.css?family=Open+Sans:400,400italic,700,600" type="text/css" media="all" />

<link rel="stylesheet" href="/css/railscasts.css">
<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />
<link rel="stylesheet" href="/css/custom.css" type="text/css" media="all" />
<link rel="stylesheet" href="/css/jquery.bigautocomplete.css" type="text/css" media="all" />
<link rel="stylesheet" href="/css/asciinema-player.css" type="text/css" media="all" />
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/fonts/fontawesome-webfont.svg" rel="stylesheet">

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/javascript" src="/js/scripts.js"></script>
<!--[if lt IE 9]>
	<script src="/js/css3-mediaqueries.js"></script>
<![endif]-->

</head>
<body id="mr-mobile" class="home blog mr-right-sb" itemscope="itemscope" itemtype="http://schema.org/WebPage">
	<div class="mr-container mr-container-outer">
		<div class="mr-header-mobile-nav clearfix"></div>
			<header class="mr-header" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
				<div class="mr-container mr-container-inner mr-row clearfix">
					<div class="mr-custom-header clearfix">
						<div class="mr-site-identity">
							<div class="mr-site-logo" role="banner" itemscope="itemscope" itemtype="http://schema.org/Brand">
								<div class="mr-header-text">
									<a class="mr-header-text-link" href="/" title="零零散散" rel="home">
										<h1 class="mr-header-title">零零散散</h1>
										<h2 class="mr-header-tagline">点滴记录</h2>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="mr-main-nav-wrap">
					<nav class="menu" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
	<ul class="menu__list">
        
            <li class="menu__item"><a class="menu__link" href="/categories/docker">docker</a></li>
        
            <li class="menu__item"><a class="menu__link" href="/categories/hadoop">hadoop</a></li>
        
            <li class="menu__item"><a class="menu__link" href="/categories/scala">scala</a></li>
        
            <li class="menu__item"><a class="menu__link" href="/categories/spark">spark</a></li>
        
            <li class="menu__item"><a class="menu__link" href="/categories/storm">storm</a></li>
        
	</ul>
</nav>
				</div>
			</header>
		<div class="mr-wrapper clearfix">


<div class="mr-content" id="main-content" role="main" itemprop="mainContentOfPage">
	<article class="post">
		<header class="entry-header clearfix">
			<h1 class="entry-title">hugo</h1>
			<p class="mr-meta entry-meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="entry-meta-date updated" datetime="2017-03-08 00:00:00 &#43;0000 UTC">March 08, 2017</time>
			</p>
		</header>
		<div class="entry-content clearfix">
			
			<div id="toc" class="toc">
<div id="toctitle">hugo</div>
<ul class="sectlevel1">
<li><a href="#_环境">1. 环境</a></li>
<li><a href="#_hugo">2. hugo</a>
<ul class="sectlevel2">
<li><a href="#_设置发布目录">2.1. 设置发布目录</a></li>
<li><a href="#_部署">2.2. 部署</a>
<ul class="sectlevel3">
<li><a href="#_带项目名">2.2.1. 带项目名</a></li>
<li><a href="#_不带项目名">2.2.2. 不带项目名</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_生成_strong_lunr_strong_索引">3. 生成 <strong>lunr</strong> 索引</a></li>
<li><a href="#_参考">4. 参考</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_环境">1. 环境</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">软件</th>
<th class="tableblock halign-left valign-top">下载地址</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ruby</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://rubyinstaller.org/downloads/">Ruby 2.3.3 (x64)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Asciidoctor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gem install asciidoctor asciidoctor-diagram</code>  &lt;1&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graphviz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.graphviz.org/Download..php">graphviz version 2.38.0</a></p></td>
</tr>
</tbody>
</table>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>asciidoctor-diagram plantuml图</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>设置淘宝gem源</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>gem sources --add https://ruby.taobao.org/ --remove https://rubygems.org/</code></pre>
</div>
</div>
</li>
<li>
<p>环境变量</p>
<div class="listingblock">
<div class="content">
<pre>Graphviz_HOME=D:\Program Files (x86)\Graphviz2.38
Path=%Path%,%Graphviz_HOME%\bin</pre>
</div>
</div>
</li>
<li>
<p>替换文件</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>替换 <code>asciidoctor-1.5.5\bin</code> 下的 <code>asciidoctor</code></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby" data-lang="ruby">#!/usr/bin/env ruby

require 'rubygems' unless defined? Gem

if File.exist?(asciidoctor = (File.expand_path '../../lib/asciidoctor', __FILE__))
  require asciidoctor
else
  require 'asciidoctor'
end
# 解析
require 'asciidoctor-diagram'
require 'asciidoctor/extensions'
require 'asciidoctor/GistBlockMacro'
Asciidoctor::Extensions.register do
    block_macro GistBlockMacro if document.basebackend? 'html'
end
#
require 'asciidoctor/cli'

invoker = Asciidoctor::Cli::Invoker.new ARGV
GC.start
invoker.invoke!
exit invoker.code</code></pre>
</div>
</div>
</li>
<li>
<p>修改 <code>asciidoctor-diagram-1.5.4\lib\asciidoctor-diagram</code> 下的 <code>extensions.rb</code></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code># 155行添加
image_name2 = ("#{parent.attr('plantimgdir')}/#{source.image_name}.#{format}")
# 187行修改
image_attributes['target'] = image_name2</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hugo">2. hugo</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_设置发布目录">2.1. 设置发布目录</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code># 创建 gh-pages 分支
git checkout --orphan gh-pages
#
git worktree add public gh-pages</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_部署">2.2. 部署</h3>
<div class="sect3">
<h4 id="_带项目名">2.2.1. 带项目名</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><a href="http://dishui.oschina.io/note-hugo/" class="bare">http://dishui.oschina.io/note-hugo/</a></p>
</div>
</blockquote>
</div>
<div class="listingblock">
<div class="title">hugo-local.sh</div>
<div class="content">
<pre class="highlightjs highlight"><code>#!/bin/sh

cd /e/note-hugo/

# 替换域名
echo "替换域名"
git checkout -- themes/mainroad/static/js/app.js content/post/base.adoc config.toml themes/mainroad/static/js/jquery.bigautocomplete.js
sed -i 's/dishui.oschina.io/localhost:1313/g' themes/mainroad/static/js/app.js content/post/base.adoc config.toml themes/mainroad/static/js/jquery.bigautocomplete.js
echo "启动 hugo server"
hugo server</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">hugo.sh</div>
<div class="content">
<pre class="highlightjs highlight"><code>#!/bin/sh

cd /e/note-hugo/

# 还原
echo "恢复域名"
git checkout -- themes/mainroad/static/js/app.js content/post/base.adoc config.toml themes/mainroad/static/js/jquery.bigautocomplete.js

echo "Generating site"
hugo

echo "Updating gh-pages branch"
cd public &amp;&amp; git add --all &amp;&amp; git commit -m "$(date +%Y-%m-%d)" &amp;&amp; git push

echo "Commit note-hugo"
cd .. &amp;&amp; git add --all &amp;&amp; git commit -m "$(date +%Y-%m-%d)" &amp;&amp; git push</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_不带项目名">2.2.2. 不带项目名</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><a href="http://dishui.oschina.io" class="bare">http://dishui.oschina.io</a></p>
</div>
</blockquote>
</div>
<div class="listingblock">
<div class="title">hugo-local.sh</div>
<div class="content">
<pre class="highlightjs highlight"><code>#!/bin/sh

cd /e/dishui/

echo "启动 hugo server"
hugo server</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">hugo-oschina.sh</div>
<div class="content">
<pre class="highlightjs highlight"><code>#!/bin/sh

cd /e/dishui/

hugo

echo "Updating gh-pages branch"
cd public &amp;&amp; git add --all &amp;&amp; git commit -m "$(date +%Y-%m-%d)" &amp;&amp; git push

echo "Commit note"
cd .. &amp;&amp; git add --all &amp;&amp; git commit -m "$(date +%Y-%m-%d)" &amp;&amp; git push</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_生成_strong_lunr_strong_索引">3. 生成 <strong>lunr</strong> 索引</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>启动 <strong>nodejieba</strong><br>
启动 <strong>docker-volume-netshare</strong> ( <a href="/post/docker/docker-base/#_mount_aws_efs_nfs_or_cifs_samba_volumes_in_docker">docker-volume-netshare</a> )</p>
</li>
<li>
<p>启动 <strong>nodejieba</strong> 容器</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>docker run -it --name=lunr --volume-driver=cifs -v 192.168.137.2/note-hugo:/hugo dishui.io:5000/nodejieba:1.1 /bin/bash</code></pre>
</div>
</div>
</li>
<li>
<p>构建索引</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>cd /hugo/content &amp;&amp; \
nodejs hugo-lunr.js &amp;&amp; \ # 生成原始数据
nodejs index_builder.js # 生成索引</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_参考">4. 参考</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://gohugo.io/tutorials/github-pages-blog/">Deployment via gh-pages branch</a></p>
</li>
<li>
<p><a href="https://github.com/BurntSushi/erd">erd</a></p>
</li>
</ol>
</div>
</div>
</div>

		</div>
		
<div class="entry-tags clearfix">
	<svg class="icon icon-tag" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m4.73135 3.3795002q0-.5597-.39604-.9557-.39604-.3961-.95577-.3961-.55974 0-.95578.3961-.39604.396-.39604.9557 0 .5598.39604.9558.39604.3961.95578.3961.55973 0 .95577-.3961.39604-.396.39604-.9558zm11.26865 6.0832q0 .5596998-.39076.9504998l-5.18548 5.196q-.41188.3908-.9610504.3908-.55974 0-.9505-.3908l-7.5511496-7.5616998q-.40132-.3907-.68119-1.0666-.27987-.6759-.27987-1.2357v-4.3934q0-.54920004.40132-.95050004.40132-.4013.9505-.4013h4.39339q.55974 0 1.23565.2799.67591.2798 1.07723.6812l7.55115 7.54060004q.39076.4118.39076.961z"/></svg>
	<ul>
		<li><a href="/tags/hugo/" rel="tag">hugo</a></li>
		
	</ul>
</div>
	</article>
	
<div class="mr-author-box clearfix">
	<figure class="mr-author-box-avatar">
		<img alt="dishui avatar" src="/src/img/dishui.png" class="avatar avatar-90 photo" height="90" width="90">
	</figure>
	<div class="mr-author-box-header">
		<span class="mr-author-box-name">About dishui</span>
	</div>
	<div class="mr-author-box-bio">
		辛勤的搬运工!!!
	</div>
</div>

	

	<nav class="mr-post-nav mr-row clearfix" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
		
		<div class="mr-col-1-2 mr-post-nav-item mr-post-nav-prev">
			<a href="/post/mathematics/xuxiaozhan/%E5%A4%9A%E5%85%83%E5%87%BD%E6%95%B0/" rel="prev"><span>«Previous</span><p>多元函数</p></a>
		</div>
		
		
		<div class="mr-col-1-2 mr-post-nav-item mr-post-nav-next">
			<a href="/post/mathematics/xuxiaozhan/%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B/" rel="next"><span>Next»</span><p>欧拉方程</p></a>
		</div>
		
	</nav>


	
</div>

<aside class="mr-sidebar" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
<div class="mr-widget widget_search navbar-wrapper" >
    <form class="search-form" role="search" >
        <label>
            <span class="screen-reader-text">Search for:</span>
            <input id="lanren" type="search" class="search-field" placeholder="Search..." value="" name="q">
        </label>
        <div id="list-container" class="bdsug" style="height: auto; display: block;">
        </div>
    </form>
    <div id="side-toc" class="entry-content">
    
    </div>
</div>
</aside>
	</div>
		<div class="mr-copyright-wrap">
			<div class="mr-container mr-container-inner clearfix">
				<p class="mr-copyright">&copy; 2017 零零散散. <a href="https://git.oschina.net/dishui/dishui" target="_blank" rel="nofollow noopener noreferrer">dishui</a>.</p>
			</div>
		</div>
	</div>

<script>
	var navigation = responsiveNav(".menu", {
		navClass: "menu--collapse",
	});
</script>
<script src="/js/asciinema-player.js"></script>
<script data-main="/js/app.js" src="/js/require.js"></script>


</body>
</html>