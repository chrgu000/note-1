<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="947px" preserveAspectRatio="none" style="width:1112px;height:947px;" version="1.1" viewBox="0 0 1112 947" width="1112px" zoomAndPan="magnify"><defs><filter height="300%" id="f38ylgjhdwz6x" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="104.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="94" y="82.1201"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="66.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="198.5" y="158.6289"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="41.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="198.5" y="491.6641"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="36.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="434" y="338.6465"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="81.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="616" y="257.1377"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="76.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="616" y="375.4009"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="126.2632" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="706" y="533.4185"/><rect fill="#FFFF99" filter="url(#f38ylgjhdwz6x)" height="36.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="711" y="622.9272"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="151.2632" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="706" y="736.1904"/><rect fill="#FFFF99" filter="url(#f38ylgjhdwz6x)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="711" y="775.9448"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="76.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="899" y="659.6816"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="99" x2="99" y1="41.1201" y2="906.208"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="203" x2="203" y1="41.1201" y2="906.208"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="313" x2="313" y1="41.1201" y2="906.208"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="439" x2="439" y1="41.1201" y2="906.208"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="621" x2="621" y1="41.1201" y2="906.208"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="711" x2="711" y1="41.1201" y2="906.208"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="903.5" x2="903.5" y1="41.1201" y2="906.208"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1068.5" x2="1068.5" y1="41.1201" y2="906.208"/><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="82" x="56" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="63" y="26.0439">MyJobTest</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="82" x="56" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="63" y="928.252">MyJobTest</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="152" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="159" y="26.0439">SparkContext</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="152" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="159" y="928.252">SparkContext</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="265" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="272" y="26.0439">HadoopRDD</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="265" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="272" y="928.252">HadoopRDD</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="372" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="379" y="26.0439">MapPartitionsRDD</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="372" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="379" y="928.252">MapPartitionsRDD</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="597" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="604" y="26.0439">RDD</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="597" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="604" y="928.252">RDD</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="655" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="662" y="26.0439">DAGScheduler</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="655" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="662" y="928.252">DAGScheduler</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="227" x="788.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="213" x="795.5" y="26.0439">DAGSchedulerEventProcessLoop</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="227" x="788.5" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="213" x="795.5" y="928.252">DAGSchedulerEventProcessLoop</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="1029.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="1036.5" y="26.0439">ActiveJob</text><rect fill="#FEFECE" filter="url(#f38ylgjhdwz6x)" height="33.1201" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="1029.5" y="905.208"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="1036.5" y="928.252">ActiveJob</text><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="104.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="94" y="82.1201"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="66.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="198.5" y="158.6289"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="41.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="198.5" y="491.6641"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="36.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="434" y="338.6465"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="81.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="616" y="257.1377"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="76.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="616" y="375.4009"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="126.2632" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="706" y="533.4185"/><rect fill="#FFFF99" filter="url(#f38ylgjhdwz6x)" height="36.7544" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="711" y="622.9272"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="151.2632" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="706" y="736.1904"/><rect fill="#FFFF99" filter="url(#f38ylgjhdwz6x)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="711" y="775.9448"/><rect fill="#FFFFCC" filter="url(#f38ylgjhdwz6x)" height="76.5088" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="899" y="659.6816"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="99" x2="146" y1="69.8745" y2="69.8745"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="146" x2="146" y1="69.8745" y2="82.8745"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="105" x2="146" y1="82.8745" y2="82.8745"/><polygon fill="#A80036" points="115,78.8745,105,82.8745,115,86.8745,111,82.8745" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="111" y="65.0181">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="122" y="65.0181">main()</text><polygon fill="#A80036" points="191.5,114.8745,201.5,118.8745,191.5,122.8745,195.5,118.8745" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="104" x2="197.5" y1="118.8745" y2="118.8745"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="111" y="114.7725">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="126" y="114.7725"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="208.5" x2="250.5" y1="151.3833" y2="151.3833"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="250.5" x2="250.5" y1="151.3833" y2="164.3833"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="209.5" x2="250.5" y1="164.3833" y2="164.3833"/><polygon fill="#A80036" points="219.5,160.3833,209.5,164.3833,219.5,168.3833,215.5,164.3833" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="215.5" y="146.5269">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="226.5" y="146.5269">sc.textFile()</text><polygon fill="#A80036" points="301.5,221.3833,311.5,225.3833,301.5,229.3833,305.5,225.3833" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="203.5" x2="307.5" y1="225.3833" y2="225.3833"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="210.5" y="221.2813">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="225.5" y="221.2813"/><polygon fill="#A80036" points="604,253.1377,614,257.1377,604,261.1377,608,257.1377" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="313.5" x2="610" y1="257.1377" y2="257.1377"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="320.5" y="253.0356">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="331.5" y="253.0356">filter</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="626" x2="668" y1="289.6465" y2="289.6465"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="668" x2="668" y1="289.6465" y2="302.6465"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="627" x2="668" y1="302.6465" y2="302.6465"/><polygon fill="#A80036" points="637,298.6465,627,302.6465,637,306.6465,633,302.6465" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="633" y="284.79">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="644" y="284.79">filter()</text><polygon fill="#A80036" points="455,334.6465,445,338.6465,455,342.6465,451,338.6465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449" x2="620" y1="338.6465" y2="338.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="461" y="334.5444">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="472" y="334.5444">new MapPartitionsRDD()</text><polygon fill="#FBFB77" filter="url(#f38ylgjhdwz6x)" points="267,315.6465,267,342.6465,425,342.6465,425,325.6465,415,315.6465,267,315.6465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="415" x2="415" y1="315.6465" y2="325.6465"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="425" x2="415" y1="325.6465" y2="325.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="273" y="335.5444">返回 MapPartitionsRDD</text><polygon fill="#A80036" points="604,371.4009,614,375.4009,604,379.4009,608,375.4009" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="439" x2="610" y1="375.4009" y2="375.4009"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="446" y="371.2988">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="457" y="371.2988">count</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="626" x2="668" y1="407.9097" y2="407.9097"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="668" x2="668" y1="407.9097" y2="420.9097"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="627" x2="668" y1="420.9097" y2="420.9097"/><polygon fill="#A80036" points="637,416.9097,627,420.9097,637,424.9097,633,420.9097" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="633" y="403.0532">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="644" y="403.0532">count</text><polygon fill="#A80036" points="214.5,447.9097,204.5,451.9097,214.5,455.9097,210.5,451.9097" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="208.5" x2="620" y1="451.9097" y2="451.9097"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="220.5" y="447.8076">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="242.5" y="447.8076"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="203.5" x2="250.5" y1="479.4185" y2="479.4185"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="250.5" x2="250.5" y1="479.4185" y2="492.4185"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="209.5" x2="250.5" y1="492.4185" y2="492.4185"/><polygon fill="#A80036" points="219.5,488.4185,209.5,492.4185,219.5,496.4185,215.5,492.4185" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="215.5" y="474.562">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="233.5" y="474.562">sc.runJob()</text><polygon fill="#A80036" points="694,529.4185,704,533.4185,694,537.4185,698,533.4185" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="203.5" x2="700" y1="533.4185" y2="533.4185"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="210.5" y="529.3164">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="228.5" y="529.3164">dagScheduler.runJob()</text><polygon fill="#FBFB77" filter="url(#f38ylgjhdwz6x)" points="8,510.4185,8,537.4185,190,537.4185,190,520.4185,180,510.4185,8,510.4185" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="180" x2="180" y1="510.4185" y2="520.4185"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="190" x2="180" y1="520.4185" y2="520.4185"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="14" y="530.3164">调用 DagScheduler.runJob()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="716" x2="758" y1="570.9272" y2="570.9272"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="758" x2="758" y1="570.9272" y2="583.9272"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="717" x2="758" y1="583.9272" y2="583.9272"/><polygon fill="#A80036" points="727,579.9272,717,583.9272,727,587.9272,723,583.9272" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="723" y="566.0708">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="741" y="566.0708">runJob()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="716" x2="763" y1="610.6816" y2="610.6816"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="763" x2="763" y1="610.6816" y2="623.6816"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="722" x2="763" y1="623.6816" y2="623.6816"/><polygon fill="#A80036" points="732,619.6816,722,623.6816,732,627.6816,728,623.6816" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="728" y="605.8252">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="746" y="605.8252">submitJob()</text><polygon fill="#A80036" points="887,655.6816,897,659.6816,887,663.6816,891,659.6816" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="711" x2="893" y1="659.6816" y2="659.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="718" y="655.5796">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="740" y="655.5796"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="909" x2="951" y1="692.1904" y2="692.1904"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="951" x2="951" y1="692.1904" y2="705.1904"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="910" x2="951" y1="705.1904" y2="705.1904"/><polygon fill="#A80036" points="920,701.1904,910,705.1904,920,709.1904,916,705.1904" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="916" y="687.334">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="934" y="687.334">post(JobSubmitted)</text><polygon fill="#A80036" points="727,732.1904,717,736.1904,727,740.1904,723,736.1904" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="721" x2="903" y1="736.1904" y2="736.1904"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="733" y="732.0884">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="751" y="732.0884">onReceive(JobSubmitted)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="721" x2="763" y1="768.6992" y2="768.6992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="763" x2="763" y1="768.6992" y2="781.6992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="722" x2="763" y1="781.6992" y2="781.6992"/><polygon fill="#A80036" points="732,777.6992,722,781.6992,732,785.6992,728,781.6992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="728" y="763.8428">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="746" y="763.8428">handleJobSubmitted()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="716" x2="758" y1="843.4536" y2="843.4536"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="758" x2="758" y1="843.4536" y2="856.4536"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="717" x2="758" y1="856.4536" y2="856.4536"/><polygon fill="#A80036" points="727,852.4536,717,856.4536,727,860.4536,723,856.4536" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="723" y="838.5972">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="741" y="838.5972">newStage()</text><polygon fill="#FBFB77" filter="url(#f38ylgjhdwz6x)" points="818,826.1992,818,853.1992,947,853.1992,947,836.1992,937,826.1992,818,826.1992" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="937" x2="937" y1="826.1992" y2="836.1992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="947" x2="937" y1="836.1992" y2="836.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="824" y="846.0972">计算宽依赖/窄依赖</text><polygon fill="#A80036" points="1056.5,883.4536,1066.5,887.4536,1056.5,891.4536,1060.5,887.4536" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="711" x2="1062.5" y1="887.4536" y2="887.4536"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="718" y="883.3516">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="736" y="883.3516">new()</text><!--
@startuml
autonumber
participant MyJobTest as my
participant SparkContext as sc
participant HadoopRDD as hr
participant MapPartitionsRDD as mpr
participant RDD as r
participant DAGScheduler as dag
participant DAGSchedulerEventProcessLoop as dagsep
participant ActiveJob as aj

my -> my: main()
activate my #ffffcc

my -> sc

sc -> sc: sc.textFile()
activate sc #ffffcc
deactivate my
sc -> hr
deactivate sc

hr -> r: filter
activate r #ffffcc

r -> r: filter()
r -> mpr: new MapPartitionsRDD()
note left: 返回 MapPartitionsRDD
deactivate r
activate mpr #ffffcc
mpr -> r: count
deactivate mpr


activate r #ffffcc
r -> r: count
r -> sc
deactivate r

sc -> sc: sc.runJob()
activate sc #ffffcc

sc -> dag: dagScheduler.runJob()
note left: 调用 DagScheduler.runJob()
deactivate sc

activate dag #ffffcc
dag -> dag: runJob()
dag -> dag: submitJob()
activate dag #ffff99
dag -> dagsep
deactivate dag
deactivate dag

activate dagsep #ffffcc
dagsep -> dagsep: post(JobSubmitted)

dagsep -> dag: onReceive(JobSubmitted)
deactivate dagsep
activate dag #ffffcc

dag -> dag: handleJobSubmitted()
activate dag #ffff99
deactivate dag
dag -> dag: newStage()
note right: 计算宽依赖/窄依赖
dag -> aj: new()
deactivate dag
@enduml

PlantUML version 1.2017.12(Thu Apr 27 00:06:36 CST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_79-b15
Operating System: Windows 8.1
OS Version: 6.3
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>