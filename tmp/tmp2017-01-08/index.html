<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title></title>
<meta name="description" content=" John Doe&#39;s Personal blog about everything">
<meta name="generator" content="Hugo 0.17" />
<meta property="og:title" content="" />
<meta property="og:description" content="SELECT zspl.*FROM zh_sub_plan_launch zsplWHERE zspl.plan_code IN(SELECT plan_codeFROM zh_plan_launch zplWHERE zpl.state = &#39;01&#39;AND zpl.table_date &gt;= ?AND zpl.table_date &#8656; ?)
SELECT *FROM zh_plan zpWHERE plan_code = ?
SELECT * FROM zh_plan zp WHERE plan_code = &#39;20170116101801016&#39;
$(this).find(&#39;[name=&#34;zhPlanCode&#34;]&#39;)$(this).find(&#39;[name=&#34;projectName&#34;]&#39;)$(this).find(&#39;[name=&#34;reservoiCode&#34;]&#39;)$(this).find(&#39;select[name=&#34;goodsCode&#34;]&#39;)$(this).find(&#39;[name=&#34;pickMode&#34;]&#39;)$(this).find(&#39;[name=&#34;shipmentAddress&#34;]&#39;)$(this).find(&#39;[name=&#34;shipmentsCount&#34;]&#39;)$(this).find(&#39;[name=&#34;receivingAddress&#34;]&#39;)$(this).find(&#39;[name=&#34;receivingUnit&#34;]&#39;)$(this).find(&#39;[name=&#34;consignee&#34;]&#39;)$(this).find(&#39;[name=&#34;receivingPhone&#34;]&#39;)$(this).find(&#39;[name=&#34;memo&#34;]&#39;)$(this).find(&#39;[name=&#34;contractCode&#34;]&#39;)
SELECT plan.plan_name,sub.*,obo.number,sub.shipments_count) - (obo.number AS w_count,gi.goods_name,gi.brand,gi.model,ra.abbreviation FROM zh_plan plan,zh_sub_plan sub LEFT JOIN zh_out_bound_order obo ON sub." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/tmp/tmp2017-01-08/" />














<link rel="stylesheet" href="/css/google-font.css?family=Open+Sans:400,400italic,700,600" type="text/css" media="all" />
<link rel="stylesheet" href="/css/atom-one-dark.css">
<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />
<link rel="stylesheet" href="/css/custom.css" type="text/css" media="all" />
<link rel="stylesheet" href="/css/jquery.bigautocomplete.css" type="text/css" media="all" />
<link rel="stylesheet" href="/css/asciinema-player.css" type="text/css" media="all" />
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/fonts/fontawesome-webfont.svg" rel="stylesheet">

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/javascript" src="/js/scripts.js"></script>
<!--[if lt IE 9]>
	<script src="/js/css3-mediaqueries.js"></script>
<![endif]-->

</head>
<body id="mr-mobile" class="home blog mr-right-sb" itemscope="itemscope" itemtype="http://schema.org/WebPage">
	<div class="mr-container mr-container-outer">
		<div class="mr-header-mobile-nav clearfix"></div>
			<header class="mr-header" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
				<div class="mr-container mr-container-inner mr-row clearfix">
					<div class="mr-custom-header clearfix">
						<div class="mr-site-identity">
							<div class="mr-site-logo" role="banner" itemscope="itemscope" itemtype="http://schema.org/Brand">
								<div class="mr-header-text">
									<a class="mr-header-text-link" href="/" title="工作笔记" rel="home">
										<h1 class="mr-header-title">工作笔记</h1>
										<h2 class="mr-header-tagline">点滴记录</h2>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="mr-main-nav-wrap">
					<nav class="menu" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
	<ul class="menu__list">
        
            <li class="menu__item"><a class="menu__link" href="/categories/docker">docker</a></li>
        
            <li class="menu__item"><a class="menu__link" href="/categories/hadoop">hadoop</a></li>
        
            <li class="menu__item"><a class="menu__link" href="/categories/spark">spark</a></li>
        
            <li class="menu__item"><a class="menu__link" href="/categories/storm">storm</a></li>
        
	</ul>
</nav>
				</div>
			</header>
		<div class="mr-wrapper clearfix">


<div class="mr-content" id="main-content" role="main" itemprop="mainContentOfPage">
	<article class="post">
		<header class="entry-header clearfix">
			<h1 class="entry-title"></h1>
			<p class="mr-meta entry-meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="entry-meta-date updated" datetime="0001-01-01 00:00:00 &#43;0000 UTC">January 01, 0001</time>
			</p>
		</header>
		<div class="entry-content clearfix">
			
			<div class="paragraph">
<p>SELECT zspl.*
FROM zh_sub_plan_launch zspl
WHERE zspl.plan_code IN
(SELECT plan_code
FROM zh_plan_launch zpl
WHERE zpl.state = '01'
AND zpl.table_date &gt;= ?
AND zpl.table_date &#8656; ?)</p>
</div>
<div class="paragraph">
<p>SELECT *
FROM zh_plan zp
WHERE plan_code = ?</p>
</div>
<div class="paragraph">
<p>SELECT * FROM zh_plan zp WHERE plan_code = '20170116101801016'</p>
</div>
<div class="paragraph">
<p>$(this).find('<strong>[name="zhPlanCode"]')
$(this).find('</strong>[name="projectName"]')
$(this).find('<strong>[name="reservoiCode"]')
$(this).find('select[name="goodsCode"]')
$(this).find('</strong>[name="pickMode"]')
$(this).find('<strong>[name="shipmentAddress"]')
$(this).find('</strong>[name="shipmentsCount"]')
$(this).find('<strong>[name="receivingAddress"]')
$(this).find('</strong>[name="receivingUnit"]')
$(this).find('<strong>[name="consignee"]')
$(this).find('</strong>[name="receivingPhone"]')
$(this).find('<strong>[name="memo"]')
$(this).find('</strong>[name="contractCode"]')</p>
</div>
<div class="paragraph">
<p>SELECT plan.plan_name,sub.*,obo.number,sub.shipments_count) - (obo.number AS w_count,gi.goods_name,gi.brand,gi.model,ra.abbreviation FROM zh_plan plan,zh_sub_plan sub LEFT JOIN zh_out_bound_order obo ON sub.zh_plan_code = obo.zh_plan_code LEFT JOIN zh_goods_info gi ON sub.goods_code = gi.goods_code LEFT JOIN zh_reservoir_area ra ON sub.shipment_address = ra.reservoir_code WHERE plan.plan_code = sub.plan_code AND plan.plan_code = '20170116154403004'</p>
</div>
<div class="paragraph">
<p>docker run -it --rm --volume-driver=cifs -v 192.168.137.2/note-hugo:/hugo ansible/centos7-ansible:1.7 /bin/bash</p>
</div>
<div class="paragraph">
<p>服务器升级:
1. Rancher(docker容器管理平台)升级
	1.1 rancher/server:v1.2 升级到 v1.3.1
	1.2 rancher/agent:v1.1.1 升级到 v1.1.3
2. CI/CD 持续集成和持续交付
	1.1 Ansible 批量部署操作
	1.2 Jenkins与Ansible结合实现一键部署重启
Bug修复:
发货申请审批:
	1. 审批中的记录-审批状态显示错误-请改为审批中
	2. 查询条件-执行状态下拉值请和审核状态一致
	3. 直销合同新增审批-先保存之后修改时点提交则审批流名称则变为招标合同
	4. 直销合同发货审批流-赊销大于5000万时少了一步营销中心总经理审批
	5. 招标合同货物审批通过后-审批状态依然显示为待审核-没有变为已审核</p>
</div>
<div class="paragraph">
<p>优点：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>1、光佳团队策划流程很到位</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>①活动人员安排：  尽管时间很紧，人员变动比较频繁，整体掌控很到位</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>②活动提前预热：  通过微信、圈子传播能够在短期内报名数60，很到位</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>③活动效果预估：  直播活动预估3万+，最终5万+</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>④活动成本预估：  赚到钱是硬道理</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>⑤活动互动效果：  笪总、美女主持人穿插广告、互动营销、红包形式的互动，提高了互动性</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>⑥活动效果公布：  通过微信、纸质形式通知效果很好</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>2、笪总团队线下配合很到位</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>①线下接待、让嘉宾没有陌生感、得到尊重感，有共同话题才是硬道理</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>②笪总的主持游刃有余，沥青届的老炮</pre>
</div>
</div>
<div class="paragraph">
<p>改善：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>1、直播体验需要提高：</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>1）直播网络稳定性、系统稳定性要提高，导致直播卡顿</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>反省：① 时间维度不够充裕：</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>中午13点到下午17点，共4个小时，时间比较紧凑，配置的设备比较多，容易影响直播效果的因素太多</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>② 技术人员切入不够早：</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>设备问题包括硬件、软件两方面，需要在启动项目时，尽早切入，以备不时之需，工作要交给擅长的人                       去做</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>2）嘉宾直播气氛需要提高</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>反省：① 房间不够大：</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>需要针对不同级别的嘉宾或者企业要有不同的配置，特别针对500强的企业要做的更加符合企业的气质</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>② 观众需要一定量级：</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>对于传统嘉宾来讲更有气氛，需要有人捧场，需要有人鼓掌，才有分享的激情</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>2、活动数据收集差</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>1）5万9的观众，如何收集起来？目前没有方法，即时有，也不够准确；</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>建议：app作为统一报名入口，但需要开发，需要周期</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>3、直播还能做什么？</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>1）广告营销：直播2小时，可以穿插广告（在直播屏幕上，不同时间段穿插广告）</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>2）延长营销：直播仅仅2个小时，如何能够让2个小时的营销效果时间延长，个人认为可以将直播经典内容沉淀下来</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>可以分段营销，在不同的地点、平台均可以</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>3）直播专场：此次是学术界的直播，后期可以做专场，譬如采购、销售、大客户比如中石化、中海油、京博等等</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>建议：提前准备听众</pre>
</div>
</div>
<div class="paragraph">
<p>优点:
	运营部在人员少,资源少,时间紧的情况下办好一场很精彩的直播.</p>
</div>
<div class="paragraph">
<p>改善:
	直播环境准备:
		1. 电脑
			笔记本和台式机都要准备,做好一比一测试,如果其中一台电脑有问题,可以用另一台电脑做备用
		2. 直播过程中可以插播公司广告,公司宣传片,充分利用直播平台
		3. 需要准备足够多的观众,烘托现场气氛</p>
</div>
<div class="paragraph">
<p>SELECT
  mp_tmp.product_name AS product_name_noa,
  mp_tmp.<strong>,
  mpa_tmp.</strong>
FROM
  (SELECT
    *
  FROM
    mlq_product
  WHERE gmt_modify &gt; '2016-07-22'
  ) mp_tmp,
  (SELECT
    mpa.product_id,
    MAX(
      CASE
        mpa.attr_name
        WHEN '销售地区'
        THEN IFNULL(
          tranAddr (mpa.attr_value, '-'),
          CAST(mpa.attr_value AS CHAR(50))
        )
        ELSE NULL
      END
    ) sale_region,
    MAX(
      CASE
        mpa.attr_name
        WHEN '出库地区'
        THEN IFNULL(
          tranAddr (mpa.attr_value, '-'),
          CAST(mpa.attr_value AS CHAR(50))
        )
        ELSE NULL
      END
    ) repository_region,
    MAX(
      CASE
        mpa.attr_name
        WHEN '出库地区'
        THEN IFNULL(
          tranAddr (mpa.attr_value, '-'),
          CAST(mpa.attr_value AS CHAR(50))
        )
        ELSE NULL
      END
    ) repository_region_noa,
    MAX(
      CASE
        mpa.attr_name
        WHEN '最小起订量'
        THEN mpa.attr_value
        ELSE 0
      END
    ) min_quantity,
    MAX(
      CASE
        mpa.attr_name
        WHEN '库存量'
        THEN mpa.attr_value
        ELSE 0
      END
    ) stock_quantity,
    MAX(
      CASE
        mpa.attr_name
        WHEN '单位'
        THEN mpa.attr_value
        ELSE '吨'
      END
    ) unit,
    MAX(
      CASE
        mpa.attr_name
        WHEN '交货天数'
        THEN mpa.attr_value
        ELSE 7
      END
    ) delivery_day,
    MAX(
      CASE
        mpa.attr_name
        WHEN '包装类型'
        THEN mpa.attr_value
        ELSE '散装'
      END
    ) package_type
  FROM
    mlq_product_attr mpa
  WHERE mpa.product_id IN
    (SELECT
      id
    FROM
      mlq_product
    WHERE gmt_modify &gt; '2016-07-22')
  GROUP BY mpa.product_id) mpa_tmp
WHERE mp_tmp.id = mpa_tmp.product_id</p>
</div>
<div class="paragraph">
<p>大物流服务器重新规划部署:
1. CoreOS 系统安装
2. Docker 环境配置
3. Rancher Client 环境配置
4. nginx 反向代理 搭建
5. 大物流数据迁移
  5.1 Web 数据迁移
  5.2 数据库迁移</p>
</div>
<div class="paragraph">
<p>Mai沥青 PC 端 Bug 修复
大物流 PC 端 Bug 修复</p>
</div>
<div class="paragraph">
<p>docker create --volumes-from rancher-server \
 --name rancher-data rancher/server:1.2</p>
</div>
<div class="paragraph">
<p>docker run -d --volumes-from rancher-data \
  -p 9090:8080 rancher/server:stable</p>
</div>
<div class="paragraph">
<p>jw.name("bool");
jw.beginObject();
jw.name("must");
jw.beginArray();
jw.beginObject();
jw.name("match");
jw.beginObject();
jw.name("cat_code");
jw.value("20150914q0asfEw");
jw.endObject();
jw.endObject();
jw.beginObject();
jw.name("match");
jw.beginObject();
jw.name("goods_status");
jw.value("c");
jw.endObject();
jw.endObject();
jw.endArray();
jw.endObject();</p>
</div>
<div class="paragraph">
<p>docker run -d --name=httpd -p 8088:80 --volume-driver=cifs -v 192.168.137.2/note-hugo/public:/usr/local/apache2/htdocs/ httpd:2.2.32-alpine</p>
</div>
<div class="paragraph">
<p>供应商：&lt;input name="new_seller_nick" type="text" value="${param.new_seller_nick }"/&gt;&lt;/span&gt;
商品名称：&lt;input name="title" type="text" value="${param.title }"/&gt;&lt;/span&gt;
商品编号：&lt;input name="id" type="text"/&gt;&lt;/span&gt;
品牌：&lt;select name="brand_id" id="brand_id"&gt;&lt;/select&gt;&lt;/span&gt;
管理类目：&lt;select name="cat_code" id="first_category"&gt;</p>
</div>
<div class="paragraph">
<p>server {
    listen       9090;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    error_log /var/log/nginx/rancher-error.log
    access_log /var/log/nginx/rancher-access.log
    location / {
        proxy_redirect          off;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header REMOTE-HOST $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://192.168.1.129:9090;
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>docker run -d --volumes-from rancher-data -p 9090:8080 --name rancher-server rancher/server:stable</p>
</div>
<div class="paragraph">
<p>docker run -d -p 192.168.1.129:8080:8080 --name rancher-server rancher/server:stable</p>
</div>
<div class="paragraph">
<p>dishui.io:5000/nginx:stable</p>
</div>
<div class="paragraph">
<p>syslog-address               tcp://192.168.137.20:514</p>
</div>
<div class="paragraph">
<p>cat &gt;&gt; /opt/logio/docker-entrypoint.sh &lt;&lt;EOF
if [ "$2" = 'rsyslogd' ]; then
  rsyslogd -n
fi
EOF</p>
</div>
<div class="paragraph">
<p>cat &gt; /etc/nginx/conf.d/default.conf &lt;&lt;EOF
server {
    listen       80;
    access_log /var/log/nginx/test.log;
    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }
}
EOF</p>
</div>
<div class="paragraph">
<p><a href="http://192.168.1.129:8080/v2-beta/schemas" class="bare">http://192.168.1.129:8080/v2-beta/schemas</a>
9FFE6681FF339A1A747D
m2E45BeYUxzr7FSAeNvhiR4R18hQL1n7nCdNQnqi</p>
</div>
<div class="paragraph">
<p>SYSLOG_SERVER=192.168.137.20
SYSLOG_PORT=514
SYSLOG_PROTO=tcp</p>
</div>
<div class="paragraph">
<p>-e 'SYSLOG_SERVER=192.168.137.20'-e 'SYSLOG_PORT=514'-e 'SYSLOG_PROTO=tcp'</p>
</div>
<div class="paragraph">
<p>$ModLoad imfile
$InputFilePollInterval 10
$WorkDirectory /var/spool/rsyslog
$PrivDropToGroup adm</p>
</div>
<div class="paragraph">
<p>$template BiglogFormatTomcat,"%msg%\n"</p>
</div>
<div class="paragraph">
<p>$InputFileName /apache-tomcat-7.0.62/logs/localhost_access_log.2017-02-21.txt
$InputFileTag access-log
$InputFileStateFile stat-access-log
$InputFileSeverity info
$InputFilePersistStateInterval 25000
$InputRunFileMonitor</p>
</div>
<div class="paragraph">
<p>if $programname == 'access-log' then @192.168.137.20:514;BiglogFormatTomcat
if $programname == 'access-log' then ~</p>
</div>
<div class="paragraph">
<p>FROM wuliu/tomcat:1.0</p>
</div>
<div class="paragraph">
<p>ENV SYSLOG_SERVER 192.168.137.20
ENV SYSLOG_PORT 514
ENV SYSLOG_PROTO tcp</p>
</div>
<div class="paragraph">
<p>COPY ./tomcat.conf /etc/supervisord.conf.d/tomcat.conf
RUN yum -y install epel-release \
       &amp;&amp; yum -y install python-pip \
       &amp;&amp; pip install supervisor-logging \
       &amp;&amp; yum remove epel-release python-pip -y \
       &amp;&amp; yum clean all</p>
</div>
<div class="paragraph">
<p>echo "30 22 * * * . /usr/sbin/logrotate /etc/logrotate.conf" &gt;&gt; /var/spool/cron/root</p>
</div>
<div class="paragraph">
<p>SELECT
  zra.reservoir_code,
  zra.abbreviation,
  zs.storage_code,
  zs.storage_capacity,
  CAST(rk.model70_rk AS CHAR) AS model70_rk,
  CAST(rk.model90_rk AS CHAR) AS model90_rk,
  CAST(ck.model70_ck AS CHAR) AS model70_ck,
  CAST(ck.model90_ck AS CHAR) AS model90_ck,
  CAST(ck.modelIC_ck AS CHAR) AS modelIC_ck,
  CAST(ck.modelID_ck AS CHAR) AS modelID_ck,
  CAST(ck.modelgt_ck AS CHAR) AS modelgt_ck,
  CAST(ck.modelgz_ck AS CHAR) AS modelgz_ck,
  CAST(sc.modelIC_sc AS CHAR) AS modelIC_sc,
  CAST(sc.modelID_sc AS CHAR) AS modelID_sc,
  CAST(sc.modelgt_sc AS CHAR) AS modelgt_sc,
  CAST(sc.modelgz_sc AS CHAR) AS modelgz_sc,
  CAST(kc.model70_kc AS CHAR) AS model70_kc,
  CAST(kc.model90_kc AS CHAR) AS model90_kc,
  CAST(kc.modelIC_kc AS CHAR) AS modelIC_kc,
  CAST(kc.modelID_kc AS CHAR) AS modelID_kc,
  CAST(kc.modelgt_kc AS CHAR) AS modelgt_kc,
  CAST(kc.modelgz_kc AS CHAR) AS modelgz_kc,
  CAST(pd.model70_pd AS CHAR) AS model70_pd,
  CAST(pd.model90_pd AS CHAR) AS model90_pd,
  CAST(pd.modelIC_pd AS CHAR) AS modelIC_pd,
  CAST(pd.modelID_pd AS CHAR) AS modelID_pd,
  CAST(pd.modelgt_pd AS CHAR) AS modelgt_pd,
  pd.modelgz_pd,
  pd.model_yk,
  (SELECT
    ait.temp
  FROM
    zh_asphalt_inventory_table ait,
    zh_goods_info gi
  WHERE ait.tank = zs.storage_code
    AND ait.storage_area = zs.reservoir_code
    AND ait.goods_code = gi.goods_code) AS temp
FROM
  zh_storage zs
  LEFT JOIN zh_reservoir_area zra
    ON zs.reservoir_code = zra.reservoir_code
  LEFT JOIN
    (SELECT
      zar.storage_code,
      zar.reservoir_code,
      zar.goods_model,
      (
        CASE
          WHEN zar.goods_model = '70#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model70_rk,
      (
        CASE
          WHEN zar.goods_model = '90#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model90_rk
    FROM
      zh_asphalt_repertory zar,
      zh_goods_info gi
    WHERE zar.goods_code = gi.goods_code
      AND zar.order_type IN ('00')
      AND zar.type = '00'
    GROUP BY zar.storage_code,
      zar.reservoir_code,
      zar.goods_model) rk
    ON zs.reservoir_code = rk.reservoir_code
    AND zs.storage_code = rk.storage_code
  LEFT JOIN
    (SELECT
      zar.storage_code,
      zar.reservoir_code,
      zar.goods_model,
      (
        CASE
          WHEN zar.goods_model = '70#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model70_ck,
      (
        CASE
          WHEN zar.goods_model = '90#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model90_ck,
      (
        CASE
          WHEN zar.goods_model = 'I-C'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelIC_ck,
      (
        CASE
          WHEN zar.goods_model = 'I-D'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelID_ck,
      (
        CASE
          WHEN zar.goods_model = '高弹'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgt_ck,
      (
        CASE
          WHEN zar.goods_model = '高粘'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgz_ck
    FROM
      zh_asphalt_repertory zar,
      zh_goods_info gi
    WHERE zar.goods_code = gi.goods_code
      AND zar.order_type IN ('01', '02')
      AND zar.type = '00'
    GROUP BY zar.storage_code,
      zar.reservoir_code,
      zar.goods_model) ck
    ON zs.reservoir_code = ck.reservoir_code
    AND zs.storage_code = ck.storage_code
  LEFT JOIN
    (SELECT
      zar.storage_code,
      zar.reservoir_code,
      zar.goods_model,
      (
        CASE
          WHEN zar.goods_model = 'I-C'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelIC_sc,
      (
        CASE
          WHEN zar.goods_model = 'I-D'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelID_sc,
      (
        CASE
          WHEN zar.goods_model = '高弹'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgt_sc,
      (
        CASE
          WHEN zar.goods_model = '高粘'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgz_sc
    FROM
      zh_asphalt_repertory zar,
      zh_goods_info gi
    WHERE zar.goods_code = gi.goods_code
      AND zar.order_type IN ('02')
      AND zar.type = '00'
    GROUP BY zar.storage_code,
      zar.reservoir_code,
      zar.goods_model) sc
    ON zs.reservoir_code = sc.reservoir_code
    AND zs.storage_code = sc.storage_code
  LEFT JOIN
    (SELECT
      zar.storage_code,
      zar.reservoir_code,
      zar.goods_model,
      (
        CASE
          WHEN zar.goods_model = '70#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model70_kc,
      (
        CASE
          WHEN zar.goods_model = '90#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model90_kc,
      (
        CASE
          WHEN zar.goods_model = 'I-C'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelIC_kc,
      (
        CASE
          WHEN zar.goods_model = 'I-D'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelID_kc,
      (
        CASE
          WHEN zar.goods_model = '高弹'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgt_kc,
      (
        CASE
          WHEN zar.goods_model = '高粘'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgz_kc
    FROM
      zh_asphalt_repertory zar,
      zh_goods_info gi
    WHERE zar.goods_code = gi.goods_code
      AND zar.order_type IN ('00', '01', '02')
      AND zar.type = '00'
    GROUP BY zar.storage_code,
      zar.reservoir_code,
      zar.goods_model) kc
    ON zs.reservoir_code = kc.reservoir_code
    AND zs.storage_code = kc.storage_code
  LEFT JOIN
    (SELECT
      zar.storage_code,
      zar.reservoir_code,
      zar.goods_model,
      SUM(zar.goods_count) AS model_yk,
      (
        CASE
          WHEN zar.goods_model = '70#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model70_pd,
      (
        CASE
          WHEN zar.goods_model = '90#'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS model90_pd,
      (
        CASE
          WHEN zar.goods_model = 'I-C'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelIC_pd,
      (
        CASE
          WHEN zar.goods_model = 'I-D'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelID_pd,
      (
        CASE
          WHEN zar.goods_model = '高弹'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgt_pd,
      (
        CASE
          WHEN zar.goods_model = '高粘'
          THEN SUM(zar.goods_count)
          ELSE ''
        END
      ) AS modelgz_pd
    FROM
      zh_asphalt_repertory zar,
      zh_goods_info gi
    WHERE zar.goods_code = gi.goods_code
      AND zar.order_type IN ('05')
      AND zar.type = '00'
    GROUP BY zar.storage_code,
      zar.reservoir_code,
      zar.goods_model) pd
    ON zs.reservoir_code = pd.reservoir_code
    AND zs.storage_code = pd.storage_code
WHERE 1 = 1
GROUP BY zs.storage_code,
  zs.reservoir_code
ORDER BY zra.abbreviation DESC</p>
</div>
<div class="paragraph">
<p>WHERE zs.storage_code = 'TKH-03'</p>
</div>
<div class="paragraph">
<p>00入库单
01出库单
02生产单
03结余调整单
04倒灌单
05盘点单号</p>
</div>
<div class="paragraph">
<p>库区  名称  入库的型号(70 90等)
  储罐 罐号 库容</p>
</div>
<div class="paragraph">
<p>" SELECT"<br>
"  zar.reservoir_code,"<br>
"  zar.storage_code,"<br>
"  zar.goods_model,"<br>
"  zar.order_type"<br>
" FROM"<br>
"  zh_asphalt_repertory zar";</p>
</div>
<div class="paragraph">
<p>SELECT  zar.reservoir_code,  zar.storage_code,  zar.goods_model,  zar.order_typeFROM  zh_asphalt_repertory zar</p>
</div>
<div class="paragraph">
<p>{title:'入库数量（吨）',colspan:2},
{title:'出库数量（吨）',colspan:6},
{title:'生产数量（吨）',colspan:4},
{title:'库存数量（吨）',colspan:6},
{title:'盘点数量（吨）',colspan:6},</p>
</div>
<div class="paragraph">
<p>" SELECT "<br>
"   *"<br>
" FROM"<br>
"   zh_asphalt_repertory zar"<br>
" GROUP BY zar.reservoir_code,zar.storage_code"<br></p>
</div>
<div class="paragraph">
<p>" SELECT *"+
" FROM zh_asphalt_repertory zar"+
" WHERE zar.reservoir_code = '001'"+
" AND zar.storage_code = 'T1003'"</p>
</div>
<div class="paragraph">
<p>{id=18b0cef136694001a0849fcb1cee3a7f, reservoirCode=002, orderNo=20170222-A, orderType=00, occurDate=Wed Feb 22 00:00:00 CST 2017, storageCode=TKH-07, goodsCount=500.0000, goodsCode=077, type=00, createDate=Wed Feb 22 16:03:12 CST 2017, goodsModel=70, goodsBatch=, model70rk=500.0000}</p>
</div>
<div class="paragraph">
<p>SELECT
  *,
  (SELECT
    zra.abbreviation
  FROM
    zh_reservoir_area zra
  WHERE zra.reservoir_code = zar.reservoir_code) AS abbreviation,
  (SELECT
    zs.storage_capacity
  FROM
    zh_storage zs
  WHERE zs.reservoir_code = zar.reservoir_code
    AND zs.storage_code = zar.storage_code) AS storage_capacity
FROM
  zh_asphalt_repertory zar
GROUP BY zar.reservoir_code,
  zar.storage_code</p>
</div>
<div class="paragraph">
<p>HAVING 1=1
AND zar.reservoir_code = '001'
AND zar.storage_code = 'T1003'
AND zar.occur_date = '2017-01-17'
ORDER BY abbreviation</p>
</div>
<div class="paragraph">
<p>LIMIT 0, 10</p>
</div>
<div class="paragraph">
<p>周凯(男) 29岁 洛阳师范-生物技术 本科生 现在北京金兆路华电子商务担任Java开发工程师</p>
</div>
<div class="paragraph">
<p>工作经验:
2013-2014 地点:郑州  OA,ERP系统开发
2015-~    地点:北京   电商系统开发</p>
</div>
<div class="paragraph">
<p>喜欢全栈</p>
</div>
<div class="paragraph">
<p>电商系统开发:
  二次开发系统,搜索模块由Lucene迁移到ElasticSearch
  同步Mysql数据到ElasticSearch
  ElasticSearch权重设计</p>
</div>
<div class="paragraph">
<p>服务器部署:
  CoreOS+Docker
  Rancher
  Jenkins+Ansible+Docker
  实现自动化部署</p>
</div>
<div class="paragraph">
<p>喜欢研究技术
希望通过Leader课程,系统的学习</p>
</div>
<div class="paragraph">
<p>" SELECT zas.category"+
" FROM zh_asphalt_storage zas"+
" GROUP BY zas.category"+
" HAVING zas.category IS NOT NULL"</p>
</div>
<div class="paragraph">
<p>" SELECT *"+
" FROM zh_asphalt_storage zas"+
" WHERE zas.category = '01'"+
" GROUP BY zas.model";</p>
</div>
<div class="literalblock">
<div class="content">
<pre>String categorySql =
        " SELECT *"+
        " FROM zh_asphalt_storage zas"+
        " WHERE zas.category = '01'"+
        " GROUP BY zas.model";</pre>
</div>
</div>
<div class="paragraph">
<p>AsphaltStorageServiceImpl</p>
</div>
<div class="paragraph">
<p>" SELECT "+
"   *,"+
"   zas.instruct_type,"+
"   zas.Net_profit_loss,"+
"   zas.Storage_area,"+
"   DATE_FORMAT(zas.in_date, '%Y-%m-%d') AS dat,"+
"   (SELECT "+
"     SUM(zasc.goods_count) "+
"   FROM"+
"     zh_asphalt_storage_count zasc "+
"   WHERE zasc.asphalt_number = zas.asphalt_number) AS goods_count,"+
"   (SELECT "+
"     zra.abbreviation "+
"   FROM"+
"     zh_reservoir_area zra "+
"   WHERE zra.reservoir_code = zas.Storage_area) AS abbreviation "+
" FROM"+
"   zh_asphalt_storage zas "+
" ORDER BY zas.in_date DESC"</p>
</div>
<div class="paragraph">
<p>SELECT
  Storage_area
FROM
  zh_sr_productin
WHERE 1=1</p>
</div>
<div class="paragraph">
<p>" SELECT"<br>
"  *, DATE_FORMAT(storage_date, '%Y-%m-%d') AS dat2"<br>
" FROM"<br>
"   zh_sr_productin"<br>
" WHERE Storage_area = ?"<br></p>
</div>
<div class="paragraph">
<p>SELECT
 *, DATE_FORMAT(out_date, '%Y-%m-%d') AS dat2
FROM
  zh_material_outbound
WHERE Storage_area = '001'</p>
</div>
<div class="paragraph">
<p>" SELECT"<br>
                "  *, DATE_FORMAT(storage_date, '%Y-%m-%d') AS dat2"<br>
                " FROM"<br>
                "   zh_material_outbound"<br>
                " WHERE Storage_area = ?"</p>
</div>
<div class="paragraph">
<p>" SELECT"+
"   zmo.model,"+
"   zmo.number,"+
"   DATE_FORMAT(zmo.out_date, '%Y-%m-%d') AS dat2,"+
"   (SELECT"+
"     zra.abbreviation"+
"   FROM"+
"     zh_reservoir_area zra"+
"   WHERE zra.reservoir_code = zmo.Storage_area) Storage_area"+
" FROM"+
"   zh_material_outbound zmo"+
" WHERE zmo.Storage_area = ?"</p>
</div>
<div class="paragraph">
<p>SELECT
 zar.reservoir_code,
 zar.storage_code,
 zar.goods_model,
 zar.order_type
FROM
 zh_asphalt_repertory zar
WHERE zar.order_type =
GROUP BY zar.goods_model</p>
</div>
<div class="paragraph">
<p>jquery.bigautocomplete.js</p>
</div>
<div class="paragraph">
<p>echo "public" &gt;&gt; .gitignore &amp;&amp; \
echo "themes/mainroad/static/js/app.js" &gt;&gt; .gitignore &amp;&amp; \
echo "themes/mainroad/static/js/jquery.bigautocomplete.js" &gt;&gt; .gitignore &amp;&amp; \
echo "config.toml" &gt;&gt; .gitignore &amp;&amp; \
echo "content/post/base.adoc" &gt;&gt; .gitignore</p>
</div>
<div class="paragraph">
<p>baseurl = "http://dishui.oschina.io/note-hugo/"</p>
</div>
<div class="paragraph">
<p>version: '2'
services:
  zoo1:
    image: zookeeper
    restart: always
    ports:
      - 2181:2181
    environment:
      ZOO_MY_ID: 1
      ZOO_SERVERS: server.1=zoo1:2888:3888
07.阿里开源分布式框架dubbo</p>
</div>
<div class="paragraph">
<p>9df8e09ee259
cadc21522a4a
e3eb53c850a3
0ec18fcb5f14
dcfb02a0f0c0
1ae259b410a4
9a0db3e1e5fa
a299de9d8b43
2354e58c407f</p>
</div>
<div class="paragraph">
<p>" SELECT"<br>
"   dat.*,"<br>
"   SUM(dat.rksl) AS count_rk,"<br>
"   SUM(dat.cksl) AS count_ck,"<br>
"   (SELECT"<br>
"     SUM(zar.goods_count)"<br>
"   FROM"<br>
"     zh_asphalt_repertory zar"<br>
"   WHERE dat.goods_code = zar.goods_code"<br>
"     AND TYPE = '01') AS count_kc,"<br>
"   SUM(dat.scsl) AS count_sc,"<br>
"   SUM(dat.pdsl) AS count_pdf"<br>
" FROM"<br>
"   (SELECT"<br>
"     DATE_FORMAT(sp.storage_date, '%Y-%m-%d') AS storage_date,"<br>
"     sp.Storage_area,"<br>
"     sp.reservoir_code,"<br>
"     sp.goods_code,"<br>
"     gi.goods_name,"<br>
"     sp.brand,"<br>
"     sp.model,"<br>
"     sp.specifications,"<br>
"     sp.Inventory_quantity AS rksl,"<br>
"     '' AS cksl,"<br>
"     '' AS scsl,"<br>
"     '' AS pdsl"<br>
"   FROM"<br>
"     zh_sr_productin sp,"<br>
"     zh_goods_info gi"<br>
"   WHERE sp.goods_code = gi.goods_code"<br>
"   UNION"<br>
"   ALL"<br>
"   SELECT"<br>
"     mo.start_date,"<br>
"     mo.Storage_area,"<br>
"     ra.abbreviation,"<br>
"     mo.goods_code,"<br>
"     gi.goods_name,"<br>
"     mo.brand,"<br>
"     mo.model,"<br>
"     mo.specifications,"<br>
"     '',"<br>
"     mo.number,"<br>
"     '',"<br>
"     ''"<br>
"   FROM"<br>
"     zh_material_outbound mo,"<br>
"     zh_goods_info gi,"<br>
"     zh_reservoir_area ra"<br>
"   WHERE mo.Storage_area = ra.reservoir_code"<br>
"     AND mo.goods_code = gi.goods_code"<br>
"   UNION"<br>
"   ALL"<br>
"   SELECT"<br>
"     DATE_FORMAT(zps.start_time, '%Y-%m-%d'),"<br>
"     pp.Storage_area,"<br>
"     pp.reservoir_code,"<br>
"     zps.Name_commodity,"<br>
"     gi.goods_name,"<br>
"     zps.brand,"<br>
"     zps.model,"<br>
"     zps.specifications,"<br>
"     '',"<br>
"     '',"<br>
"     zps.Production_quantity,"<br>
"     ''"<br>
"   FROM"<br>
"     zh_production_subsidiary zps,"<br>
"     zh_goods_info gi,"<br>
"     zh_production_processing pp"<br>
"   WHERE pp.Production_order = zps.production_order"<br>
"     AND zps.goods_code = gi.goods_code"<br>
"   UNION"<br>
"   ALL"<br>
"   SELECT"<br>
"     DATE_FORMAT(ait.<code>data</code>, '%Y-%m-%d'),"<br>
"     ra.abbreviation,"<br>
"     ait.storage_area,"<br>
"     ait.accessories_name,"<br>
"     gi.goods_name,"<br>
"     ait.brand,"<br>
"     ait.model,"<br>
"     ait.specifications,"<br>
"     '',"<br>
"     '',"<br>
"     '',"<br>
"     ait.inventory_number"<br>
"   FROM"<br>
"     zh_additive_inventory_table ait,"<br>
"     zh_goods_info gi,"<br>
"     zh_reservoir_area ra"<br>
"   WHERE ait.storage_area = ra.reservoir_code"<br>
"     AND gi.goods_code = ait.accessories_name) dat"<br>
" WHERE 1 = 1";</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>向 namenode 请求上传文件 /a/sss.txt</p>
</li>
<li>
<p>响应,可以上传</p>
</li>
<li>
<p>rpc 请求上传第一个 block(0-128M), 请求返回 datanode</p>
</li>
<li>
<p>返回 (datanode1,datanode2,datanode3)</p>
</li>
<li>
<p>请求建立 block 传输通道 channel
5.1. 请求建立通道
5.2. 请求建立通道
6.1. 应答成功
6.2. 应答成功</p>
</li>
<li>
<p>请求建立通道</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>考虑因素: 空间/距离</p>
</div>
<div class="paragraph">
<p>上传数据时, datanode 的选择策略
1. 第一个副本先考虑跟 client 离最近的 (同机架)
2. 第二个副本再考虑跨机架挑选一个 datanode, 增加副本的可靠性
3. 第三个副本就在第一个副本同机架另外挑选一台 datanode 存放</p>
</div>
<div class="paragraph">
<p>SELECT
  dat.*,
  SUM(dat.rksl) AS count_rk,
  SUM(dat.cksl) AS count_ck,
  (SELECT
    SUM(zar.goods_count)
  FROM
    zh_asphalt_repertory zar
  WHERE dat.goods_code = zar.goods_code
    AND TYPE = '01') AS count_kc,
  SUM(dat.scsl) AS count_sc,
  SUM(dat.pdsl) AS count_pdf
FROM
  (SELECT
    DATE_FORMAT(sp.storage_date, '%Y-%m-%d') AS storage_date,
    sp.Storage_area,
    sp.reservoir_code,
    sp.goods_code,
    gi.goods_name,
    sp.brand,
    sp.model,
    sp.specifications,
    sp.Inventory_quantity AS rksl,
    '' AS cksl,
    '' AS scsl,
    '' AS pdsl
  FROM
    zh_sr_productin sp,
    zh_goods_info gi
  WHERE sp.goods_code = gi.goods_code
  UNION
  ALL
  SELECT
    mo.start_date,
    mo.Storage_area,
    ra.abbreviation,
    mo.goods_code,
    gi.goods_name,
    mo.brand,
    mo.model,
    mo.specifications,
    '' AS rksl,
    mo.number AS cksl,
    '' AS scsl,
    '' AS pdsl
  FROM
    zh_material_outbound mo,
    zh_goods_info gi,
    zh_reservoir_area ra
  WHERE mo.Storage_area = ra.reservoir_code
    AND mo.goods_code = gi.goods_code
  UNION
  ALL
  SELECT
    DATE_FORMAT(zps.start_time, '%Y-%m-%d'),
    pp.Storage_area,
    pp.reservoir_code,
    zps.Name_commodity,
    gi.goods_name,
    zps.brand,
    zps.model,
    zps.specifications,
    '' AS rksl,
    '' AS cksl,
    zps.Production_quantity AS scsl,
    '' AS pdsl
  FROM
    zh_production_subsidiary zps,
    zh_goods_info gi,
    zh_production_processing pp
  WHERE pp.Production_order = zps.production_order
    AND zps.goods_code = gi.goods_code
  UNION
  ALL
  SELECT
    DATE_FORMAT(ait.<code>data</code>, '%Y-%m-%d'),
    ra.abbreviation,
    ait.storage_area,
    ait.accessories_name,
    gi.goods_name,
    ait.brand,
    ait.model,
    ait.specifications,
    '' AS rksl,
    '' AS cksl,
    '' AS scsl,
    ait.inventory_number AS pdsl
  FROM
    zh_additive_inventory_table ait,
    zh_goods_info gi,
    zh_reservoir_area ra
  WHERE ait.storage_area = ra.reservoir_code
    AND gi.goods_code = ait.accessories_name) dat
WHERE 1 = 1
GROUP BY dat.goods_code
ORDER BY dat.storage_date DESC</p>
</div>
<div class="paragraph">
<p>" SELECT"<br>
"   dat.*,"<br>
"   SUM(dat.rksl) AS count_rk,"<br>
"   SUM(dat.cksl) AS count_ck,"<br>
"   (SELECT"<br>
"     SUM(zar.goods_count)"<br>
"   FROM"<br>
"     zh_asphalt_repertory zar"<br>
"   WHERE dat.goods_code = zar.goods_code"<br>
"     AND TYPE = '01') AS count_kc,"<br>
"   SUM(dat.scsl) AS count_sc,"<br>
"   SUM(dat.pdsl) AS count_pdf"<br>
" FROM"<br>
"   (SELECT"<br>
"     DATE_FORMAT(sp.storage_date, '%Y-%m-%d') AS storage_date,"<br>
"     sp.Storage_area,"<br>
"     sp.reservoir_code,"<br>
"     sp.goods_code,"<br>
"     gi.goods_name,"<br>
"     sp.brand,"<br>
"     sp.model,"<br>
"     sp.specifications,"<br>
"     sp.Inventory_quantity AS rksl,"<br>
"     '' AS cksl,"<br>
"     '' AS scsl,"<br>
"     '' AS pdsl"<br>
"   FROM"<br>
"     zh_sr_productin sp,"<br>
"     zh_goods_info gi"<br>
"   WHERE sp.goods_code = gi.goods_code"<br>
"   UNION"<br>
"   ALL"<br>
"   SELECT"<br>
"     mo.start_date,"<br>
"     ra.abbreviation AS Storage_area,"<br>
"     mo.Storage_area AS reservoir_code,"<br>
"     mo.goods_code,"<br>
"     gi.goods_name,"<br>
"     mo.brand,"<br>
"     mo.model,"<br>
"     mo.specifications,"<br>
"     '' AS rksl,"<br>
"     mo.number AS cksl,"<br>
"     '' AS scsl,"<br>
"     '' AS pdsl"<br>
"   FROM"<br>
"     zh_material_outbound mo,"<br>
"     zh_goods_info gi,"<br>
"     zh_reservoir_area ra"<br>
"   WHERE mo.Storage_area = ra.reservoir_code"<br>
"     AND mo.goods_code = gi.goods_code"<br>
"   UNION"<br>
"   ALL"<br>
"   SELECT"<br>
"     DATE_FORMAT(zps.start_time, '%Y-%m-%d'),"<br>
"     pp.Storage_area,"<br>
"     pp.reservoir_code,"<br>
"     zps.goods_code,"<br>
"     zps.Name_commodity AS goods_name,"<br>
"     zps.brand,"<br>
"     zps.model,"<br>
"     zps.specifications,"<br>
"     '' AS rksl,"<br>
"     '' AS cksl,"<br>
"     zps.Production_quantity AS scsl,"<br>
"     '' AS pdsl"<br>
"   FROM"<br>
"     zh_production_subsidiary zps,"<br>
"     zh_goods_info gi,"<br>
"     zh_production_processing pp"<br>
"   WHERE pp.Production_order = zps.production_order"<br>
"     AND zps.goods_code = gi.goods_code"<br>
"   UNION"<br>
"   ALL"<br>
"   SELECT"<br>
"     DATE_FORMAT(ait.<code>data</code>, '%Y-%m-%d'),"<br>
"     ra.abbreviation,"<br>
"     ait.storage_area,"<br>
"     ait.accessories_name AS goods_code,"<br>
"     gi.goods_name,"<br>
"     ait.brand,"<br>
"     ait.model,"<br>
"     ait.specifications,"<br>
"     '' AS rksl,"<br>
"     '' AS cksl,"<br>
"     '' AS scsl,"<br>
"     ait.inventory_number AS pdsl"<br>
"   FROM"<br>
"     zh_additive_inventory_table ait,"<br>
"     zh_goods_info gi,"<br>
"     zh_reservoir_area ra"<br>
"   WHERE ait.storage_area = ra.reservoir_code"<br>
"     AND gi.goods_code = ait.accessories_name) dat"<br>
" GROUP BY dat.reservoir_code,"<br>
"   dat.goods_code"<br></p>
</div>
<div class="paragraph">
<p>GRANT ALL PRIVILEGES ON <strong>.</strong> TO 'root'@'%' IDENTIFIED BY '111111' WITH GRANT OPTION;
mysql&gt; flush privileges;</p>
</div>
<div class="paragraph">
<p>docker run -it --rm \
  --net=hadoop \
  --volume-driver=cifs \
  -v 192.168.137.2/hadoop:/hadoop \
  --hostname hadoop-master \
  kiwenlau/hadoop:1.0</p>
</div>
<div class="paragraph">
<p>&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
    &lt;value&gt;jdbc:mysql://mysql:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt;
    &lt;description&gt;JDBC connect string for a JDBC metastore&lt;/description&gt;
  &lt;/property&gt;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;property&gt;
  &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
  &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
  &lt;description&gt;Driver class name for a JDBC metastore&lt;/description&gt;
&lt;/property&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;property&gt;
  &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
  &lt;value&gt;root&lt;/value&gt;
  &lt;description&gt;username to use against metastore database&lt;/description&gt;
&lt;/property&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
    &lt;value&gt;111111&lt;/value&gt;
    &lt;description&gt;password to use against metastore database&lt;/description&gt;
  &lt;/property&gt;
&lt;/configuration&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>create database shizhan03;</p>
</div>
<div class="paragraph">
<p>use shizhan03;</p>
</div>
<div class="paragraph">
<p>create table t_sz01(id int,name string);</p>
</div>
<div class="paragraph">
<p>drop table t_sz01;</p>
</div>
<div class="paragraph">
<p>create table t_sz01(id int,name string) row format delimited fields terminated by ',';</p>
</div>
<div class="paragraph">
<p>vi /sz.dat</p>
</div>
<div class="paragraph">
<p>1,zhangsan
2,lisi
3,fengjie
4,chunge
5,shizi
6,koukjj</p>
</div>
<div class="paragraph">
<p>hadoop fs -put /sz.dat /user/hive/warehouse/shizhan03.db/t_sz01</p>
</div>
<div class="paragraph">
<p>select * from t_sz01;</p>
</div>
<div class="paragraph">
<p>select count(1) from t_sz01;</p>
</div>
<div class="paragraph">
<p>select id,name from t_sz01 where id&gt;3;</p>
</div>
<div class="paragraph">
<p>show tables;</p>
</div>
<div class="paragraph">
<p>create exte</p>
</div>
<div class="paragraph">
<p>sed -i 's/dishui.oschina.io\/note-hugo/localhost:1313/g' themes/mainroad/static/js/app.js content/post/base.adoc config.toml</p>
</div>
<div class="paragraph">
<p>git checkout&#8201;&#8212;&#8201;themes/mainroad/static/js/app.js content/post/base.adoc config.toml</p>
</div>
<div class="paragraph">
<p>cat &lt;&lt;&lt; 'FLUME_CLASSPATH="/opt/flume/lib"' &gt; flume-env.sh</p>
</div>
<div class="paragraph">
<p>curl <a href="https://raw.githubusercontent.com/burnettk/delete-docker-registry-image/master/delete_docker_registry_image.py" class="bare">https://raw.githubusercontent.com/burnettk/delete-docker-registry-image/master/delete_docker_registry_image.py</a> | sudo tee /opt/bin/delete_docker_registry_image &gt;/dev/null</p>
</div>
<div class="paragraph">
<p>sudo chmod a+x /opt/bin/delete_docker_registry_image</p>
</div>
<div class="paragraph">
<p>export REGISTRY_DATA_DIR=/home/core/registry/docker/registry/v2</p>
</div>
<div class="paragraph">
<p>{
    "server":"0.0.0.0",
    "server_port":8888,
    "local_address": "127.0.0.1",
    "local_port":1080,
    "password":"111111",
    "timeout":300,
    "method":"aes-256-cfb",
    "fast_open": false,
    "workers": 1
}</p>
</div>
<div class="paragraph">
<p>SELECT zspl.*
FROM zh_sub_plan_launch zspl,
zh_send_goods_check zsgc
WHERE zspl.plan_code IN
(SELECT plan_code
FROM zh_plan_launch zpl
WHERE zpl.state = '01'
AND zpl.table_date &gt;= '2017-03-24 14:44:19'
AND zpl.table_date &#8656; '2017-03-24 23:44:25')
AND zspl.project_name = zsgc.project_name
AND zsgc.make_time = '2017-03-24'
AND zsgc.status  = '4'</p>
</div>
<div class="paragraph">
<p>storm jar examples/storm-starter/storm-starter-topologies-0.9.6.jar org.apache.storm.starter.WordCountTopology wordcount</p>
</div>
<div class="paragraph">
<p>2017-03-28_163004
2017-03-28_163014
2017-03-28_163023
2017-03-28_163035
2017-03-28_163042
2017-03-28_163050
2017-03-28_163058
2017-03-28_163734
2017-03-28_163743
2017-03-28_163751
2017-03-28_163757
2017-03-28_163804
2017-03-28_163811</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>image::{img}/img/storm/.png[]</p>
</div>
<div class="paragraph">
<p>docker run -d -p 8888:1984 oddrationale/docker-shadowsocks -s 0.0.0.0 -p 1984 -k 111111 -m aes-256-cfb</p>
</div>
<div class="paragraph">
<p>/v2/tutum/influxdb/manifests/0.9</p>
</div>
<div class="paragraph">
<p>SELECT zspl.* FROM zh_sub_plan_launch zspl, zh_send_goods_check zsgc WHERE zspl.plan_code IN (SELECT plan_code FROM zh_plan_launch zpl WHERE zpl.state = '01' AND zpl.table_date &gt;= '2017-03-29 00:35:07' AND zpl.table_date &#8656; '2017-03-29 23:35:14') AND zspl.project_name = zsgc.project_name AND zsgc.make_time = '2017-03-29' AND zspl.goods_code = zsgc.goods_name AND zsgc.status  = '4'</p>
</div>
<div class="paragraph">
<p>hi 陈经理:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>大物流服务器配置(高-中-低),在附件的三个sheet里,请下载查看</pre>
</div>
</div>
<div class="paragraph">
<p>谢谢</p>
</div>
<div class="paragraph">
<p>version: '2'
services:
  registry2:
    image: dishui.io:5000/registry:2.5
    container_name: registry2
    ports:
      - "5000:5000"
    environment:
      REGISTRY_HTTP_TLS_CERTIFICATE: /certs/registry.crt
      REGISTRY_HTTP_TLS_KEY: /certs/registry.key
    volumes:
      - /home/core/registrydata:/var/lib/registry
      - /home/core/registry/certs:/certs</p>
</div>
<div class="paragraph">
<p>2017-04-01_104025
2017-04-01_104135
2017-04-01_104143
2017-04-01_104152
2017-04-01_104159
2017-04-01_104213</p>
</div>
<div class="paragraph">
<p>val lines = List("hello tom hello jerry","hello tom kitty hello hello")</p>
</div>
<div class="paragraph">
<p>lines.flatMap(<em>.split(" ")).map</em>,1.groupBy(<em>._1).map(t &#8658; (t._1,t._2.size)).toList.sortBy(</em>._2)</p>
</div>
<div class="paragraph">
<p>io.dishui.test.construct</p>
</div>
<div class="paragraph">
<p>2017-04-07_145546.png
2017-04-07_145555.png
2017-04-07_145603.png
2017-04-07_145612.png
2017-04-07_145620.png
2017-04-07_145627.png</p>
</div>
<div class="paragraph">
<p>2017-04-07_151513.png
2017-04-07_151523.png</p>
</div>
<div class="paragraph">
<p>bin/spark-submit \
--class org.apache.spark.examples.SparkPi \
--master spark://master:7077 \
--executor-memory 512M \
--total-executor-cores 1 \
lib/spark-examples-1.5.2-hadoop2.2.0.jar \
10</p>
</div>
<div class="literalblock">
<div class="title">/bin/spark-submit \</div>
<div class="content">
<pre>--class org.apache.spark.examples.SparkPi \
--master spark://master:7077 \
--executor-memory 512M \
--total-executor-cores 2 \
/usr/local/spark-1.5.2/lib/spark-examples-1.5.2-hadoop2.2.0.jar \
10</pre>
</div>
</div>
<div class="paragraph">
<p>cd $SPARK_HOME</p>
</div>
<div class="paragraph">
<p>bin/spark-shell --master spark://master:7077</p>
</div>
<div class="paragraph">
<p>cat &gt; log4j.properties &lt;&lt;_EOF_
# Set everything to be logged to the console
log4j.rootCategory=ERROR, console
log4j.appender.console=org.apache.log4j.ConsoleAppender
log4j.appender.console.target=System.err
log4j.appender.console.layout=org.apache.log4j.PatternLayout
log4j.appender.console.layout.ConversionPattern=%d{yy/MM/dd HH:mm:ss} %p %c{1}: %m%n</p>
</div>
<h1 id="_settings_to_quiet_third_party_logs_that_are_too_verbose" class="sect0">Settings to quiet third party logs that are too verbose</h1>
<div class="paragraph">
<p>log4j.logger.org.spark-project.jetty=WARN
log4j.logger.org.spark-project.jetty.util.component.AbstractLifeCycle=ERROR
log4j.logger.org.apache.spark.repl.SparkIMain$exprTyper=INFO
log4j.logger.org.apache.spark.repl.SparkILoop$SparkILoopInterpreter=INFO
log4j.logger.org.apache.parquet=ERROR
log4j.logger.parquet=ERROR</p>
</div>
<h1 id="_spark_9183_settings_to_avoid_annoying_messages_when_looking_up_nonexistent_udfs_in_sparksql_with_hive_support" class="sect0">SPARK-9183: Settings to avoid annoying messages when looking up nonexistent UDFs in SparkSQL with Hive support</h1>
<div class="paragraph">
<p>log4j.logger.org.apache.hadoop.hive.metastore.RetryingHMSHandler=FATAL
log4j.logger.org.apache.hadoop.hive.ql.exec.FunctionRegistry=ERROR
<em>EOF</em></p>
</div>

		</div>
		
	</article>
	
<div class="mr-author-box clearfix">
	<figure class="mr-author-box-avatar">
		<img alt="dishui avatar" src="/src/img/dishui.png" class="avatar avatar-90 photo" height="90" width="90">
	</figure>
	<div class="mr-author-box-header">
		<span class="mr-author-box-name">About dishui</span>
	</div>
	<div class="mr-author-box-bio">
		辛勤的搬运工!!!
	</div>
</div>

	

	<nav class="mr-post-nav mr-row clearfix" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
		
		<div class="mr-col-1-2 mr-post-nav-item mr-post-nav-prev">
			<a href="/src/records_bak/test/" rel="prev"><span>«Previous</span><p></p></a>
		</div>
		
		
		<div class="mr-col-1-2 mr-post-nav-item mr-post-nav-next">
			<a href="/tmp/wuliuxiugai/" rel="next"><span>Next»</span><p></p></a>
		</div>
		
	</nav>


	
</div>

<aside class="mr-sidebar" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
<div class="mr-widget widget_search navbar-wrapper" >
    <form class="search-form" role="search" >
        <label>
            <span class="screen-reader-text">Search for:</span>
            <input id="lanren" type="search" class="search-field" placeholder="Search..." value="" name="q">
        </label>
        <div id="list-container" class="bdsug" style="height: auto; display: block;">
        </div>
    </form>
    <div id="side-toc" class="entry-content">
    
    </div>
</div>
</aside>
	</div>
		<div class="mr-copyright-wrap">
			<div class="mr-container mr-container-inner clearfix">
				<p class="mr-copyright">&copy; 2017 工作笔记. <a href="https://git.oschina.net/dishui/dishui" target="_blank" rel="nofollow noopener noreferrer">dishui</a>.</p>
			</div>
		</div>
	</div>

<script>
	var navigation = responsiveNav(".menu", {
		navClass: "menu--collapse",
	});
</script>
<script src="/js/asciinema-player.js"></script>
<script data-main="/js/app.js" src="/js/require.js"></script>


</body>
</html>